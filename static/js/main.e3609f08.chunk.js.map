{"version":3,"sources":["token/types.ts","token/state.ts","token/BaseToken.tsx","token/DynamicToken.tsx","token/DraggableToken.tsx","token/DraggableTokenPreview.tsx","toolbar/ToolbarGroup.tsx","toolbar/ToolbarButton.tsx","toolbar/token/DeleteTokenToolbarButton.tsx","toolbar/token/TokenToolbarGroup.tsx","toolbar/history/UndoToolbarButton.tsx","toolbar/history/RedoToolbarButton.tsx","toolbar/history/HistoryToolbarGroup.tsx","toolbar/view/TogglePanelToolbarButton.tsx","toolbar/view/ViewToolbarGroup.tsx","toolbar/Toolbar.tsx","app/store.ts","app/Layout.tsx","app/App.tsx","view/state.ts","field/index.ts","forms/Forms.module.css","token/BaseToken.module.css","field/state.ts","forms/use-input.ts","forms/TextField.tsx","forms/SelectField.tsx","panel/Panel.tsx","panel/PanelCategory.tsx","panel/FieldPanel.tsx","panel/TokenSymbolField.tsx","panel/TokenColorSelection.tsx","panel/TokenDirectionSelection.tsx","panel/TokenPanel.tsx","panel/NewToken.tsx","panel/PanelContainer.tsx","toolbar/Toolbar.module.css","dnd/CustomDragLayer.tsx","dnd/DndProvider.tsx","dnd/use-disable-preview.ts","panel/NewToken.module.css","field/Cell.module.css","app/Layout.module.css","shared/text.ts","panel/PanelContainer.module.css","token/DraggableToken.module.css","panel/PanelCategory.module.css","field/Field.module.css","field/CellToken.tsx","field/Cell.tsx","field/Grid.tsx","field/Field.tsx","dnd/CustomDragLayer.module.css","field/Grid.module.css","panel/Panel.module.css","index.tsx"],"names":["Direction","slice","createSlice","name","initialState","ids","entities","reducers","createToken","state","action","payload","id","token","color","symbol","direction","push","updateToken","toggleTokenDirection","None","deleteToken","index","indexOf","splice","findTokenById","content","present","tokens","actions","BaseToken","size","selected","onTokenClick","onDirectionClick","circleRef","containerClassName","circleClassName","onCircleClick","useCallback","event","stopPropagation","useCircleClick","onNorthClick","useDirectionClick","North","onSouthClick","South","onWestClick","West","onEastClick","East","colors","saturate","chroma","get","backgroundColor","borderColor","darken","hex","textColor","getTextColor","generateColors","containerStyle","width","height","generateContainerStyle","circleStyle","generateCircleStyle","northStyle","borderWidth","generateBorderWidth","top","left","generatePosition","borderLeftWidth","borderRightWidth","borderBottomWidth","borderBottomColor","generateNorthStyle","southStyle","bottom","borderTopWidth","borderTopColor","generateSouthStyle","westStyle","borderRightColor","generateWestStyle","eastStyle","right","borderLeftColor","generateEastStyle","containerClasses","classNames","styles","container","circleClasses","circle","className","style","ref","onClick","DirectionNode","currentDirection","north","south","west","east","current","DynamicToken","useSelector","getSelectedTokenId","TOKEN_DND_TYPE","DraggableToken","props","item","useDrag","type","collect","monitor","dragging","isDragging","drag","preview","useDisablePreview","DraggableTokenPreview","offset","diff","x","y","transform","generateStyle","ToolbarGroup","children","group","ToolbarButton","label","disabled","button","DeleteTokenToolbarButton","tokenId","dispatch","useDispatch","TokenToolbarGroup","UndoToolbarButton","isUndoable","ActionCreators","undo","Object","values","sub","past","length","RedoToolbarButton","isRedoable","redo","future","HistoryToolbarGroup","TogglePanelToolbarButton","togglePanel","ViewToolbarGroup","Toolbar","memo","undoOptions","limit","groupBy","groupByActionTypes","groupedFieldActions","store","configureStore","reducer","undoable","combineReducers","field","view","selector","equalityFn","useSelectorRaw","useDispatchRaw","Layout","panel","isPanelVisible","panelWidth","gridTemplateColumns","toolbar","tokenPanel","App","updateFieldDimensions","columns","rows","clearHistory","panelVisible","selectedTokenId","undefined","selectToken","deselectToken","extraReducers","builder","addCase","isTokenSelected","module","exports","MIN_DIMENSIONS","MAX_DIMENSIONS","cells","createCell","normalizeDimension","columnsDiff","increase","columnsStart","columnsEnd","growColumns","decrease","console","log","shrinkColumns","Math","abs","rowsDiff","rowsStart","rowsEnd","growRows","shrinkRows","moveToken","removeToken","value","max","min","cell","getColumns","getRows","findCellByCoordinates","column","useInput","initialValue","listener","useState","setValue","useEffect","onChange","target","TextField","onFocus","changeHandler","useChangeHandler","bind","element","input","maxLength","SelectField","options","currentValue","optionsNormalized","useMemo","map","transformOption","useOptions","selectStyle","option","find","getSelectStyle","useSelectStyle","select","generateOption","Panel","title","PanelCategory","FieldPanel","Dimensions","columnsChanged","rowsChanged","DimensionSelect","range","TokenSymbolField","createColor","normalizeColor","toLowerCase","TokenColorSelection","directions","TokenDirectionSelection","TokenPanel","NEW_TOKEN","NewToken","tokenWrapper","PanelContainer","dynamic","newToken","CustomDragLayer","useDragLayer","getItem","itemType","getItemType","currentOffset","getSourceClientOffset","renderPreview","layer","DndProvider","backend","HTML5Backend","empty","Image","captureDraggingState","src","BLACK_TEXT","WHITE_TEXT","contrast","CellToken","useTokenClickHandler","useDirectionClickHandler","position","Cell","firstRow","lastColumn","useDrop","accept","canDrop","drop","uuidv4","handleDrop","isOver","useDroppable","droppable","cellSize","Grid","generateGridStyle","generateCells","grid","Field","gridWrapper","ReactDOM","render","document","getElementById"],"mappings":"qGAAO,IAAKA,E,+XAAAA,K,cAAAA,E,cAAAA,E,YAAAA,E,YAAAA,E,aAAAA,M,wBCcCC,EAAQC,YAAY,CAC7BC,KAAM,SACNC,aAPwB,CACxBC,IAAK,GACLC,SAAU,IAMVC,SAAU,CAENC,YAFM,SAEMC,EAAOC,GAAqC,IAAD,EACVA,EAAOC,QAAxCC,EAD2C,EAC3CA,GACFC,EAAQ,CAAED,KAAIE,MAF+B,EACvCA,MACeC,OAFwB,EAChCA,OACgBC,UAFgB,EACxBA,WAE3BP,EAAMJ,IAAIY,KAAKL,GACfH,EAAMH,SAASM,GAAMC,GAGzBK,YATM,SASMT,EAAOC,GACf,IAAME,EAAKF,EAAOC,QAAQC,GACpBC,EAAQJ,EAAMH,SAASM,GAEzBC,IACAJ,EAAMH,SAASM,GAAf,2BACOC,GACAH,EAAOC,WAKtBQ,qBArBM,SAqBeV,EAAOC,GAA8D,IAAD,EAC3DA,EAAOC,QAAzBC,EAD6E,EAC7EA,GAAII,EADyE,EACzEA,UACNH,EAAQJ,EAAMH,SAASM,GAExBC,IAIDA,EAAMG,YAAcA,EACpBH,EAAMG,UAAYA,EAElBH,EAAMG,UAAYhB,EAAUoB,OAIpCC,YApCM,SAoCMZ,EAAOC,GAAwC,IAC/CE,EAAOF,EAAOC,QAAdC,GACFU,EAAQb,EAAMJ,IAAIkB,QAAQX,GAE5BU,GAAS,IACTb,EAAMJ,IAAImB,OAAOF,EAAO,UACjBb,EAAMH,SAASM,QAQzBa,EAAgB,SAAChB,EAAkBG,GAAnB,OAAqDH,EAAMiB,QAAQC,QAAQC,OAAOtB,SAASM,I,EAOpHX,EAAM4B,QAJNrB,E,EAAAA,YACAU,E,EAAAA,YACAC,E,EAAAA,qBACAE,E,EAAAA,Y,+EC5CG,SAASS,EAAT,GAYI,IAXPlB,EAWM,EAXNA,GACAmB,EAUM,EAVNA,KACAjB,EASM,EATNA,MACAC,EAQM,EARNA,OACAC,EAOM,EAPNA,UACAgB,EAMM,EANNA,SACAC,EAKM,EALNA,aACAC,EAIM,EAJNA,iBACAC,EAGM,EAHNA,UACAC,EAEM,EAFNA,mBACAC,EACM,EADNA,gBAGMC,EAmGV,SACI1B,EACAqB,GAEA,OAAOM,uBAAY,SAACC,GACZP,IACAO,EAAMC,kBACNR,EAAarB,MAElB,CAACA,EAAIqB,IA5GcS,CAAe9B,EAAIqB,GACnCU,EAAeC,EAAkB5C,EAAU6C,MAAOjC,EAAIsB,GACtDY,EAAeF,EAAkB5C,EAAU+C,MAAOnC,EAAIsB,GACtDc,EAAcJ,EAAkB5C,EAAUiD,KAAMrC,EAAIsB,GACpDgB,EAAcN,EAAkB5C,EAAUmD,KAAMvC,EAAIsB,GAIpDkB,EA2HV,SAAwBtC,GACpB,IACMuC,EADeC,IAAOxC,GAAOyC,IAAI,SACP,GAAK,EAAI,EAEzC,MAAO,CACHC,gBAAiB1C,EACjB2C,YAAaH,IAAOxC,GAAO4C,OAAO,GAAGL,SAASA,GAAUM,MACxDC,UAAWC,YAAa/C,IAlIbgD,CAAehD,GACxBiD,EAqIV,SAAgChC,GAC5B,MAAO,CACHiC,MAAOjC,EAAO,KACdkC,OAAQlC,EAAO,MAxIImC,CAAuBnC,GACxCoC,EA2IV,SAA6Bf,GACzB,MAAO,CACHI,gBAAiBJ,EAAOI,gBACxBC,YAAaL,EAAOK,YACpB3C,MAAOsC,EAAOQ,WA/IEQ,CAAoBhB,GAClCiB,EAkJV,SAA4BtC,EAAcqB,GACtC,IAAMkB,EAAcC,EAAoBxC,GACxC,MAAO,CACHyC,IAAK,EACLC,KAAMC,EAAiB3C,GACvB4C,gBAAiBL,EACjBM,iBAAkBN,EAClBO,kBAAmBP,EACnBQ,kBAAmB1B,EAAOK,aA1JXsB,CAAmBhD,EAAMqB,GACtC4B,EA6JV,SAA4BjD,EAAcqB,GACtC,IAAMkB,EAAcC,EAAoBxC,GACxC,MAAO,CACHkD,OAAQ,EACRR,KAAMC,EAAiB3C,GACvB4C,gBAAiBL,EACjBM,iBAAkBN,EAClBY,eAAgBZ,EAChBa,eAAgB/B,EAAOK,aArKR2B,CAAmBrD,EAAMqB,GACtCiC,EAwKV,SAA2BtD,EAAcqB,GACrC,IAAMkB,EAAcC,EAAoBxC,GACxC,MAAO,CACHyC,IAAKE,EAAiB3C,GACtB0C,KAAM,EACNS,eAAgBZ,EAChBO,kBAAmBP,EACnBM,iBAAkBN,EAClBgB,iBAAkBlC,EAAOK,aAhLX8B,CAAkBxD,EAAMqB,GACpCoC,EAmLV,SAA2BzD,EAAcqB,GACrC,IAAMkB,EAAcC,EAAoBxC,GACxC,MAAO,CACHyC,IAAKE,EAAiB3C,GACtB0D,MAAO,EACPP,eAAgBZ,EAChBO,kBAAmBP,EACnBK,gBAAiBL,EACjBoB,gBAAiBtC,EAAOK,aA3LVkC,CAAkB5D,EAAMqB,GAEpCwC,EAAmBC,IACrBC,IAAOC,UADwB,eAE5BD,IAAO9D,SAAWA,GACrBI,GAGE4D,EAAgBH,IAClBC,IAAOG,OACP5D,GAKJ,OACI,sBACI6D,UAAWN,EACXO,MAAOpC,EAFX,UAKI,qBACIqC,IAAKjE,EACLkE,QAAS/D,EACT4D,UAAWF,EACXG,MAAOhC,EAJX,SAMI,+BAAOpD,MAGX,cAACuF,EAAD,CACItF,UAAWhB,EAAU6C,MACrB0D,iBAAkBvF,EAClBqF,QAAS1D,EACTuD,UAAWJ,IAAOU,MAClBL,MAAO9B,IAGX,cAACiC,EAAD,CACItF,UAAWhB,EAAU+C,MACrBwD,iBAAkBvF,EAClBqF,QAASvD,EACToD,UAAWJ,IAAOW,MAClBN,MAAOnB,IAGX,cAACsB,EAAD,CACItF,UAAWhB,EAAUiD,KACrBsD,iBAAkBvF,EAClBqF,QAASrD,EACTkD,UAAWJ,IAAOY,KAClBP,MAAOd,IAGX,cAACiB,EAAD,CACItF,UAAWhB,EAAUmD,KACrBoD,iBAAkBvF,EAClBqF,QAASnD,EACTgD,UAAWJ,IAAOa,KAClBR,MAAOX,OAOvB,SAASc,EAAT,GAMoB,IALhBtF,EAKe,EALfA,UACAuF,EAIe,EAJfA,iBACAF,EAGe,EAHfA,QACAH,EAEe,EAFfA,UACAC,EACe,EADfA,MAEMS,EAAU5F,IAAcuF,EAC9B,OACI,qBACIF,QAASA,EACTH,UAAWL,IAAWK,EAAWJ,IAAO9E,UAAnB,eAAiC8E,IAAOc,QAAUA,IACvET,MAAOA,IAmBnB,SAASvD,EACL5B,EAAsBJ,EACtBsB,GAEA,OAAOK,uBAAY,SAACC,GACZN,IACAM,EAAMC,kBACNP,EAAiBtB,EAAII,MAE1B,CAACA,EAAWJ,EAAIsB,IAqFvB,SAASqC,EAAoBxC,GACzB,OAASA,EAAO,GAAM,EAAK,KAG/B,SAAS2C,EAAiB3C,GACtB,OAAQA,EAAO,EAAK,K,0CC7OjB,SAAS8E,EAAT,GAQI,IAPPjG,EAOM,EAPNA,GACAmB,EAMM,EANNA,KACAE,EAKM,EALNA,aACAC,EAIM,EAJNA,iBACAC,EAGM,EAHNA,UACAC,EAEM,EAFNA,mBACAC,EACM,EADNA,gBAGML,EAAW8E,aAAY,SAAArG,GAAK,OAAIsG,YAAmBtG,KAAWG,KAC9DC,EAAQiG,aAAY,SAAArG,GAAK,OAAIgB,EAAchB,EAAOG,MAClDG,EAASF,EAAQA,EAAME,OAAS,GAChCD,EAAQD,EAAQA,EAAMC,MAAQ,UAC9BE,EAAYH,EAAQA,EAAMG,UAAYhB,EAAUoB,KAEtD,OACI,cAACU,EAAD,CACIlB,GAAIA,EACJmB,KAAMA,EACNjB,MAAOA,EACPC,OAAQA,EACRC,UAAWA,EACXgB,SAAUA,EACVC,aAAcA,EACdC,iBAAkBA,EAClBC,UAAWA,EACXC,mBAAoBA,EACpBC,gBAAiBA,I,qBC9BhB2E,EAAiB,QAOvB,SAASC,EAAeC,GAAe,IAClCtG,EAAasG,EAAbtG,GAAImB,EAASmF,EAATnF,KAENoF,EAAqB,CAAEvG,KAAImB,QAHQ,EAKHqF,aAAQ,iBAAO,CACjDC,KAAML,EACNG,OACAG,QAAS,SAACC,GAAD,MAAc,CAAEC,WAAYD,EAAQE,kBAC7C,CAAC7G,EAAImB,IATgC,mBAKhCyF,EALgC,KAKhCA,SAAYE,EALoB,KAKdC,EALc,KAWzCC,YAAkBD,GAElB,IAAMvF,EAAqByD,IAAW,eACjCC,IAAO0B,SAAWA,IAGvB,OACI,cAACX,EAAD,2BACQK,GADR,IAEI/E,UAAWuF,EACXtF,mBAAoBA,EACpBC,gBAAiByD,IAAOG,UClC7B,SAAS4B,EAAT,GAII,IAHPjH,EAGM,EAHNA,GACAmB,EAEM,EAFNA,KAGMoE,EAWV,SAAuBpE,EAAc+F,GACjC,IAAMC,EAAQhG,EAAO,GAAM,EACrBiG,EAAIF,EAAOE,EAAID,EACfE,EAAIH,EAAOG,EAAIF,EACrB,MAAO,CAAEG,UAAU,aAAD,OAAeF,EAAf,eAAuBC,EAAvB,QAfJE,CAAcpG,EADtB,EADN+F,QAGA,OACI,qBAAK3B,MAAOA,EAAZ,SACI,cAACU,EAAD,CACIjG,GAAIA,EACJmB,KAAMA,Q,uNCZf,SAASqG,EAAT,GAA4C,IAApBC,EAAmB,EAAnBA,SAC3B,OACI,qBAAKnC,UAAWJ,IAAOwC,MAAvB,SACKD,I,kBCDN,SAASE,EAAT,GAII,IAHPC,EAGM,EAHNA,MACAC,EAEM,EAFNA,SACApC,EACM,EADNA,QAEA,OACI,wBACIH,UAAWJ,IAAO4C,OAClBrC,QAASA,EACToC,SAAUA,EAHd,SAKKD,ICdN,SAASG,IACZ,IAAMC,EAAU9B,GAAY,SAACrG,GAAD,OAAWsG,YAAmBtG,MACpDgI,GAAYG,EAEZC,EAAWC,IACXzC,EAAU9D,uBAAY,WACpBqG,GACAC,EAASxH,YAAY,CACjBT,GAAIgI,OAGb,CAACA,EAASC,IAEb,OACI,cAACN,EAAD,CACIC,MAAM,SACNC,SAAUA,EACVpC,QAASA,ICpBd,SAAS0C,IACZ,OACI,cAACX,EAAD,UACI,cAACO,EAAD,MCFL,SAASK,IACZ,IACMP,GADW3B,EAAYmC,GAGvBJ,EAAWC,IAGjB,OACI,cAACP,EAAD,CACIC,MAAM,OACNnC,QALQ,kBAAMwC,EAASK,iBAAeC,SAMtCV,SAAUA,IAKtB,SAASQ,EAAWxI,GAChB,cAAkB2I,OAAOC,OAAO5I,GAAhC,eAAwC,CAAnC,IACK6I,EADI,KAGV,GAAIA,GAAOA,EAAIC,MAAQD,EAAIC,KAAKC,OAAS,EACrC,OAAO,EAIf,OAAO,ECzBJ,SAASC,IACZ,IACMhB,GADW3B,EAAY4C,GAGvBb,EAAWC,IAGjB,OACI,cAACP,EAAD,CACIC,MAAM,OACNnC,QALQ,kBAAMwC,EAASK,iBAAeS,SAMtClB,SAAUA,IAKtB,SAASiB,EAAWjJ,GAChB,cAAkB2I,OAAOC,OAAO5I,GAAhC,eAAwC,CAAnC,IACK6I,EADI,KAGV,GAAIA,GAAOA,EAAIM,QAAUN,EAAIM,OAAOJ,OAAS,EACzC,OAAO,EAIf,OAAO,ECzBJ,SAASK,IACZ,OACI,eAACzB,EAAD,WACI,cAACY,EAAD,IACA,cAACS,EAAD,OCJL,SAASK,IACZ,IAAMjB,EAAWC,IAGjB,OACI,cAACP,EAAD,CACIC,MAAM,QACNnC,QALQ,kBAAMwC,EAASkB,kBCH5B,SAASC,IACZ,OACI,cAAC5B,EAAD,UACI,cAAC0B,EAAD,MCKL,I,EAAMG,EAAUC,gBAAK,YAA2B,IAAxBhE,EAAuB,EAAvBA,UAC3B,OACI,sBAAKA,UAAWL,IAAWC,IAAOC,UAAWG,GAA7C,UACI,cAAC6C,EAAD,IACA,cAACc,EAAD,IACA,cAACG,EAAD,U,sCCTNG,EAAc,CAChBC,MAAO,IACPC,QAASC,6BAAmBC,wBAGnBC,EAAQC,YAAe,CAChCC,QAAQ,aACJhJ,QAASiJ,IAASC,aAAe,mBAC5BhJ,IAAOzB,KAAOyB,IAAO8I,SADO,cAE5BG,QAAM1K,KAAO0K,QAAMH,SAFS,IAG7BP,IACHW,IAAK3K,KAAO2K,IAAKJ,WAOnB,SAAS5D,EACZiE,EACAC,GAEA,OAAOC,YAAeF,EAAUC,GAG7B,IAAMlC,EAAc,kBAAMoC,e,uBCvB1B,SAASC,IACZ,IAAMC,EAAQtE,EAAYuE,KACpBlF,EAWV,SAAgCiF,GAC5B,IACME,EAAaF,EAAQ,QAAU,MAErC,MAAO,CACHG,oBAAoB,GAAD,OAJJ,OAII,YAAmBD,IAhB5BpH,CAAuBkH,GAErC,OACI,sBAAKlF,UAAWJ,IAAOC,UAAWI,MAAOA,EAAzC,UACI,cAAC8D,EAAD,CAAS/D,UAAWJ,IAAO0F,UAC3B,cAAC,QAAD,CAAOtF,UAAWJ,IAAO+E,QACxBO,EAAQ,cAAC,IAAD,CAAgBlF,UAAWJ,IAAO2F,aAAiB,QCTjE,SAASC,IACZ,OACI,cAAC,aAAD,UACI,cAAC,IAAD,CAAUlB,MAAOA,EAAjB,SACI,cAAC,IAAD,UACI,cAACW,EAAD,UAOpBX,EAAM3B,SAAS8C,gCAAsB,CACjCC,QAAS,EACTC,KAAM,KAGVrB,EAAM3B,SAASK,iBAAe4C,iB,8RChBxB1L,EAAsB,CACxB2L,cAAc,EACdC,qBAAiBC,GAGRhM,EAAQC,YAAY,CAC7BC,KAAM,OACNC,eACAG,SAAU,CAENwJ,YAFM,SAEMtJ,GACRA,EAAMsL,cAAgBtL,EAAMsL,cAGhCG,YANM,SAMMzL,EAAOC,GAAwC,IAC/CE,EAAOF,EAAOC,QAAdC,GACRH,EAAMuL,gBAAkBpL,GAG5BuL,cAXM,SAWQ1L,GACVA,EAAMuL,qBAAkBC,IAIhCG,cAAe,SAACC,GAEZA,EAAQC,QAAQjL,KAAa,SAACZ,EAAOC,GAAY,IACrCE,EAAOF,EAAOC,QAAdC,GAEJH,EAAMuL,kBAAoBpL,IAC1BH,EAAMuL,qBAAkBC,SAO3BZ,EAAiB,SAAC5K,GAAD,OAAsBA,EAAMqK,KAAKiB,cAClDhF,EAAqB,SAACtG,GAAD,OAAsBA,EAAMqK,KAAKkB,iBACtDO,EAAkB,SAAC9L,EAAkBG,GAAnB,OAAkCH,EAAMqK,KAAKkB,kBAAoBpL,G,EAM5FX,EAAM4B,QAHNkI,E,EAAAA,YACAmC,E,EAAAA,YACAC,E,EAAAA,e,gCCrDJ,q+B,mBCCAK,EAAOC,QAAU,CAAC,QAAU,uBAAuB,MAAQ,qBAAqB,MAAQ,qBAAqB,OAAS,wB,iBCAtHD,EAAOC,QAAU,CAAC,UAAY,6BAA6B,OAAS,0BAA0B,UAAY,6BAA6B,SAAW,4BAA4B,QAAU,2BAA2B,MAAQ,yBAAyB,MAAQ,yBAAyB,KAAO,wBAAwB,KAAO,0B,8BCD3T,qUAKaC,EAAiB,EACjBC,EAAiB,IAQxBvM,EAAsB,CACxBwL,QAAS,EACTC,KAAM,EACNe,MAAO,CAAE,CAAEC,EAAW,EAAG,MAGhB5M,EAAQC,YAAY,CAC7BC,KAAM,QACNC,eACAG,SAAU,CAENoL,sBAFM,SAEgBlL,EAAOC,GACzB,IAAMkL,EAAUkB,EAAmBpM,EAAOC,QAAQiL,SAC5CC,EAAOiB,EAAmBpM,EAAOC,QAAQkL,MAIzCkB,EAAcnB,EAAUnL,EAAMmL,QAEhCmB,EAAc,EAuD9B,SAAqBtM,EAAcuM,GAI/B,IAHA,IAAMC,EAAexM,EAAMmL,QACrBsB,EAAazM,EAAMmL,QAAUoB,EAE1BhF,EAAIiF,EAAcjF,EAAIkF,EAAYlF,IAAK,CAC5CvH,EAAMmM,MAAM5E,GAAK,GAEjB,IAAK,IAAIC,EAAI,EAAGA,EAAIxH,EAAMoL,KAAM5D,IAC5BxH,EAAMmM,MAAM5E,GAAGC,GAAK4E,EAAW7E,EAAGC,IA9D9BkF,CAAY1M,EAAOsM,GACZA,EAAc,GA0FrC,SAAuBtM,EAAc2M,GAIjC,IAHA,IAAMH,EAAexM,EAAMmL,QAAUwB,EAC/BF,EAAazM,EAAMmL,QAEhB5D,EAAIiF,EAAcjF,EAAIkF,EAAYlF,IACvC,IAAK,IAAIC,EAAI,EAAGA,EAAIxH,EAAMoL,KAAM5D,IAAK,CACjC,IAAMW,EAAUnI,EAAMmM,MAAM5E,GAAGC,GAE/BoF,QAAQC,IAAI,qBAAsB1E,GAI1CnI,EAAMmM,MAAMpL,OAAOyL,EAAcG,GArGrBG,CAAc9M,EAAO+M,KAAKC,IAAIV,IAGlCtM,EAAMmL,QAAUA,EAIhB,IAAM8B,EAAW7B,EAAOpL,EAAMoL,KAE1B6B,EAAW,EAqE3B,SAAkBjN,EAAcuM,GAI5B,IAHA,IAAMW,EAAYlN,EAAMoL,KAClB+B,EAAUnN,EAAMoL,KAAOmB,EAEpBhF,EAAI,EAAGA,EAAIvH,EAAMmL,QAAS5D,IAC/B,IAAK,IAAIC,EAAI0F,EAAW1F,EAAI2F,EAAS3F,IACjCxH,EAAMmM,MAAM5E,GAAGC,GAAK4E,EAAW7E,EAAGC,GA1E9B4F,CAASpN,EAAOiN,GACTA,EAAW,GA6FlC,SAAoBjN,EAAc2M,GAI9B,IAHA,IAAMO,EAAYlN,EAAMoL,KAAOuB,EACzBQ,EAAUnN,EAAMoL,KAEb7D,EAAI,EAAGA,EAAIvH,EAAMmL,QAAS5D,IAAK,CACpC,IAAK,IAAIC,EAAI0F,EAAW1F,EAAI2F,EAAS3F,IAAK,CACtC,IAAMW,EAAUnI,EAAMmM,MAAM5E,GAAGC,GAE/BoF,QAAQC,IAAI,qBAAsB1E,GAGtCnI,EAAMmM,MAAM5E,GAAGxG,OAAOmM,EAAWP,IAvGzBU,CAAWrN,EAAO+M,KAAKC,IAAIC,IAG/BjN,EAAMoL,KAAOA,GAGjBkC,UA/BM,SA+BItN,EAAOC,GAA8D,IAAD,EACrDA,EAAOC,QAApBC,EADkE,EAClEA,GAAIoH,EAD8D,EAC9DA,EAAGC,EAD2D,EAC3DA,EACf+F,EAAYvN,EAAOG,GACnBH,EAAMmM,MAAM5E,GAAGC,GAAGW,QAAUhI,IAIpCwL,cAAe,SAACC,GAEZA,EAAQC,QAAQ9L,KAAa,SAACC,EAAOC,GAAY,IAAD,EACvBA,EAAOC,QAApBC,EADoC,EACpCA,GAAIoH,EADgC,EAChCA,EAAGC,EAD6B,EAC7BA,EACfxH,EAAMmM,MAAM5E,GAAGC,GAAGW,QAAUhI,KAGhCyL,EAAQC,QAAQjL,KAAa,SAACZ,EAAOC,GAEjCsN,EAAYvN,EADGC,EAAOC,QAAdC,UAOpB,SAASkM,EAAmBmB,GACxB,OAAOT,KAAKU,IAAIxB,EAAgBc,KAAKW,IAAIxB,EAAgBsB,IAG7D,SAASpB,EAAW7E,EAAWC,EAAWW,GACtC,MAAO,CACHZ,IACAC,IACAW,WAiBR,SAASoF,EAAYvN,EAAcG,GAC/B,IAAK,IAAIoH,EAAI,EAAGA,EAAIvH,EAAMmL,QAAS5D,IAC/B,IAAK,IAAIC,EAAI,EAAGA,EAAIxH,EAAMoL,KAAM5D,IAAK,CACjC,IAAMmG,EAAO3N,EAAMmM,MAAM5E,GAAGC,GAE5B,GAAImG,EAAKxF,UAAYhI,EAAI,CACrBwN,EAAKxF,aAAUqD,EACf,QA+CT,IAAMoC,EAAa,SAAC5N,GAAD,OAAsBA,EAAMiB,QAAQC,QAAQkJ,MAAMe,SAC/D0C,EAAU,SAAC7N,GAAD,OAAsBA,EAAMiB,QAAQC,QAAQkJ,MAAMgB,MAC5D0C,EAAwB,SAAC9N,EAAkBuH,EAAWC,GAC/D,IAAMuG,EAAS/N,EAAMiB,QAAQC,QAAQkJ,MAAM+B,MAAM5E,GACjD,OAAOwG,EAASA,EAAOvG,QAAKgE,G,EAM5BhM,EAAM4B,QAFN8J,E,EAAAA,sBACAoC,E,EAAAA,UAGSxD,EAAsB,CAC/BoB,EAAsBtE,O,oLCtKboH,EAAW,SACpBC,EACAC,GACoC,IAAD,EACTC,mBAASF,GADA,mBAC5BT,EAD4B,KACrBY,EADqB,KAenC,OAZAC,qBAAU,kBAAMD,EAASH,KAAe,CAACA,IAYlC,CAVM,CACTT,QACAc,SAAU,SAACvM,GACPqM,EAASrM,EAAMwM,OAAOf,OAClBU,GACAA,EAASnM,EAAMwM,OAAOf,SAO9BA,EACAY,I,wBCXD,SAASI,EAAT,GAMI,IALPzG,EAKM,EALNA,MACA0F,EAIM,EAJNA,IACAD,EAGM,EAHNA,MACAc,EAEM,EAFNA,SACAG,EACM,EADNA,QAEMC,EAiBV,SACIjB,EACAa,GAEA,OAAOxM,uBAAY,SAAC0L,GACZA,EAAMzE,QAAU0E,GAChBa,EAASd,KAEd,CAACC,EAAKa,IAzBaK,CAAiBlB,EAAKa,GADtC,EAESN,EAASR,EAAOkB,GAAxBE,EAFD,oBAIN,OACI,sBAAKnJ,UAAWJ,IAAOwJ,QAAvB,UACK9G,EAAQ,uBAAOtC,UAAWJ,IAAO0C,MAAzB,SAAiCA,IAAiB,KAC3D,mCACItC,UAAWJ,IAAOyJ,MAClBlI,KAAK,OACLmI,UAAWtB,EACXgB,QAASA,GACLG,OCbb,SAASI,EAAT,GAKI,IAJPjH,EAIM,EAJNA,MACAkH,EAGM,EAHNA,QACAzB,EAEM,EAFNA,MAGMkB,EAoBV,SAA0BJ,GACtB,OAAOxM,uBAAY,SAAC0L,GACZc,GACAA,EAASd,KAEd,CAACc,IAzBkBK,CADhB,EADNL,UACM,EAEuBN,EAASR,EAAOkB,GAFvC,mBAECE,EAFD,KAEOM,EAFP,KAIAC,EAyBV,SAAoBF,GAChB,OAAOG,mBACH,kBAAMH,EAAQI,IAAIC,KAClB,CAACL,IA5BqBM,CAAWN,GAC/BO,EAuDV,SAAwBN,EAAsBD,GAC1C,OAAOG,mBACH,kBAKR,SAAwBF,EAAsBD,GAC1C,IAAMQ,EAASR,EAAQS,MAAK,SAAAD,GAAM,OAAIA,EAAOjC,QAAU0B,KACvD,OAAOO,EAASA,EAAO/J,MAAQ,KAPrBiK,CAAeT,EAAcD,KACnC,CAACC,EAAcD,IA1DCW,CAAeV,EAAcC,GAEjD,OACI,sBAAK1J,UAAWJ,IAAOwJ,QAAvB,UACK9G,EAAQ,uBAAOtC,UAAWJ,IAAO0C,MAAzB,SAAiCA,IAAiB,KAC3D,gDACItC,UAAWJ,IAAOwK,OAClBnK,MAAO8J,GACHZ,GAHR,aAKKO,EAAkBE,IAAIS,SAqBvC,SAASR,EAAgBG,GACrB,IAAIjC,EAAQ,KACRzF,EAAQ,KACRrC,OAAQ8F,EAcZ,MAZsB,kBAAXiE,GAAkC,OAAXA,QAAoCjE,IAAjBiE,EAAOjC,OACxDA,EAAQiC,EAAOjC,MACfzF,EAAQ0H,EAAO1H,MACfrC,EAAQ+J,EAAO/J,OAEf8H,EAAQiC,EAAS,GAGP,OAAV1H,QAA4ByD,IAAVzD,IAClBA,EAAQyF,GAGL,CACHA,QACAzF,QACArC,SAgBR,SAASoK,EAAT,GAA0D,IAAhCtC,EAA+B,EAA/BA,MAAOzF,EAAwB,EAAxBA,MAAOrC,EAAiB,EAAjBA,MACpC,OACI,wBAEID,UAAWJ,IAAOoK,OAClBjC,MAAOA,EACP9H,MAAOA,EAJX,SAMKqC,GALIyF,G,4BCxFV,SAASuC,EAAT,GAAuD,IAAtCC,EAAqC,EAArCA,MAAOpI,EAA8B,EAA9BA,SAAUnC,EAAoB,EAApBA,UACrC,OACI,sBAAKA,UAAWA,EAAhB,UACI,oBAAIA,UAAWJ,IAAO2K,MAAtB,SAA8BA,IAC7BpI,K,qBCLN,SAASqI,EAAT,GAAoD,IAA3BD,EAA0B,EAA1BA,MAAOpI,EAAmB,EAAnBA,SACnC,OACI,sBAAKnC,UAAWJ,IAAOC,UAAvB,UACK0K,EAAQ,oBAAIvK,UAAWJ,IAAO2K,MAAtB,SAA8BA,IAAc,KACpDpI,KCJN,SAASsI,IACZ,OACI,cAACH,EAAD,CAAOC,MAAM,QAAb,SACI,cAACG,EAAD,MAKZ,SAASA,IACL,IAAM/H,EAAWC,cACX8C,EAAU9E,YAAYuH,cACtBxC,EAAO/E,YAAYwH,WAEnBuC,EAAiBtO,uBAAY,SAACqJ,GAChC/C,EAAS8C,gCAAsB,CAC3BC,UACAC,YAEL,CAAChD,EAAUgD,IAERiF,EAAcvO,uBAAY,SAACsJ,GAC7BhD,EAAS8C,gCAAsB,CAC3BC,UACAC,YAEL,CAAChD,EAAU+C,IAEd,OACI,eAAC8E,EAAD,WACI,cAACK,EAAD,CACIvI,MAAM,UACNyF,MAAOrC,EACPmD,SAAU8B,IAEd,cAACE,EAAD,CACIvI,MAAM,OACNyF,MAAOpC,EACPkD,SAAU+B,OAY1B,SAASC,EAAT,GAI0B,IAHtBvI,EAGqB,EAHrBA,MACAyF,EAEqB,EAFrBA,MACAc,EACqB,EADrBA,SAEMW,EAAUsB,IAAMtE,iBAAgBC,iBAAiB,GACvD,OACI,cAAC8C,EAAD,CACIjH,MAAOA,EACPkH,QAASA,EACTzB,MAAOA,EAAQ,GACfc,SAAUA,I,WC3Df,SAASkC,EAAT,GAA0C,IAAdrQ,EAAa,EAAbA,GACzBG,EAAS+F,aAAY,SAAArG,GAAU,IAAD,EAC1BM,EAAM,UAAGU,YAAchB,EAAOG,UAAxB,aAAG,EAA0BG,OACzC,OAAOA,GAAkB,MAGvB8H,EAAWC,cACXiG,EAAWxM,uBAAY,SAACxB,GAC1B8H,EAAS3H,YAAY,CACjBN,KACAG,cAEL,CAAC8H,EAAUjI,IAId,OACI,cAACqO,EAAD,CACIzG,MAAM,SACN0F,IAAK,EACLD,MAAOlN,EACPgO,SAAUA,EACVG,QARQ,SAAC1M,GAAD,OAA4BA,EAAMwM,OAAOsB,Y,YCjBvDlN,EAAS,CACX8N,EAAY,SAAU,WACtBA,EAAY,MAAO,WACnBA,EAAY,SAAU,WACtBA,EAAY,OAAQ,WACpBA,EAAY,QAAS,WACrBA,EAAY,OAAQ,WACpBA,EAAY,cAAe,WAC3BA,EAAY,WAAY,WACxBA,EAAY,cAAe,WAC3BA,EAAY,YAAa,WACzBA,EAAY,aAAc,WAC1BA,EAAY,YAAa,YAG7B,SAASA,EAAY1I,EAAe1H,GAChC,MAAO,CACH0H,QACAyF,MAAOkD,EAAerQ,GACtBqF,MAAO,CACH3C,gBAAiB1C,EACjBA,MAAO+C,YAAa/C,KAKhC,SAASqQ,EAAerQ,GACpB,OAAOA,EAAQA,EAAMsQ,cAAgB,KAQlC,SAASC,EAAT,GAA6C,IAAdzQ,EAAa,EAAbA,GAC5BE,EAAQgG,aAAY,SAAArG,GAAU,IAAD,EAE/B,OAAO0Q,EADI,UAAG1P,YAAchB,EAAOG,UAAxB,aAAG,EAA0BE,UAItC+H,EAAWC,cACXiG,EAAWxM,uBAAY,SAACzB,GAC1B+H,EAAS3H,YAAY,CACjBN,KACAE,aAEL,CAAC+H,EAAUjI,IAEd,OAAOE,EACH,cAAC2O,EAAD,CACIjH,MAAM,QACNkH,QAAStM,EACT6K,MAAOnN,EACPiO,SAAUA,IAEd,KCzDR,IAAMuC,EAAa,CACf,CAAE9I,MAAO,qBAAYyF,MAAOjO,IAAU6C,OACtC,CAAE2F,MAAO,oBAAWyF,MAAOjO,IAAUmD,MACrC,CAAEqF,MAAO,qBAAYyF,MAAOjO,IAAU+C,OACtC,CAAEyF,MAAO,oBAAWyF,MAAOjO,IAAUiD,MACrC,CAAEuF,MAAO,OAAQyF,MAAOjO,IAAUoB,OAO/B,SAASmQ,EAAT,GAAiD,IAAd3Q,EAAa,EAAbA,GAChCI,EAAY8F,aAAY,SAAArG,GAAU,IAAD,EAC7BO,EAAS,UAAGS,YAAchB,EAAOG,UAAxB,aAAG,EAA0BI,UAC5C,OAAOA,GAAwBhB,IAAUoB,QAGvCyH,EAAWC,cACXiG,EAAWxM,uBAAY,SAACvB,GAC1B6H,EAAS3H,YAAY,CACjBN,KACAI,iBAEL,CAAC6H,EAAUjI,IAEd,OACI,cAAC6O,EAAD,CACIjH,MAAM,YACNkH,QAAS4B,EACTrD,MAAOjN,EACP+N,SAAUA,IC1Bf,SAASyC,EAAT,GAAoC,IAAd5Q,EAAa,EAAbA,GACzB,OACI,cAAC4P,EAAD,CAAOC,MAAM,QAAb,SACI,eAACC,EAAD,WACI,cAACO,EAAD,CAAkBrQ,GAAIA,IACtB,cAACyQ,EAAD,CAAqBzQ,GAAIA,IACzB,cAAC2Q,EAAD,CAAyB3Q,GAAIA,S,4CCThC6Q,EAAY,CACrB7Q,GAAI,GACJE,MAAO,UACPC,OAAQ,GACRC,UAAWhB,IAAUoB,MAGnB+F,EAAqB,CACvBvG,GAAI6Q,EAAU7Q,GACdmB,KAAM,KAGH,SAAS2P,IAAY,IAAD,EACetK,aAAQ,iBAAO,CACjDC,KAAML,IACNG,OACAG,QAAS,SAACC,GAAD,MAAc,CAAEC,WAAYD,EAAQE,mBAJ1B,mBACdD,EADc,KACdA,SAAYE,EADE,KACIC,EADJ,KAOvBC,YAAkBD,GAElB,IAAMzB,EAAYL,IACdC,IAAOjF,MADiB,eAErBiF,IAAO0B,SAAWA,IAGzB,OACI,cAACgJ,EAAD,CAAOC,MAAM,cAAcvK,UAAWJ,IAAOsF,MAA7C,SACI,qBAAKlF,UAAWJ,IAAO6L,aAAvB,SACI,cAAC,IAAD,CACI/Q,GAAIuG,EAAKvG,GACTmB,KAAMoF,EAAKpF,KACXjB,MAAO2Q,EAAU3Q,MACjBC,OAAO,GACPC,UAAWhB,IAAUoB,KACrBY,UAAU,EACVG,UAAWuF,EACXrF,gBAAiB6D,Q,qBC/BxB0L,EAAiB1H,gBAAK,YAA0B,IAAvBhE,EAAsB,EAAtBA,UAC5B8F,EAAkBlF,YAAYC,KAEpC,OACI,sBAAKb,UAAWL,IAAWC,IAAOC,UAAWG,GAA7C,UACI,qBAAKA,UAAWJ,IAAO+L,QAAvB,SACK7F,EACK,cAACwF,EAAD,CAAY5Q,GAAIoL,IAChB,cAAC2E,EAAD,MAGV,qBAAKzK,UAAWJ,IAAOgM,SAAvB,SACI,cAACJ,EAAD,a,gBCxBhBlF,EAAOC,QAAU,CAAC,UAAY,2BAA2B,MAAQ,uBAAuB,OAAS,0B,mKCG1F,SAASsF,IAAmB,IAAD,EAM1BC,aAAa,SAAAzK,GAAO,MAAK,CACzBJ,KAAMI,EAAQ0K,UACdC,SAAU3K,EAAQ4K,cAClBC,cAAe7K,EAAQ8K,wBACvB5K,WAAYF,EAAQE,iBARpBN,EAF0B,EAE1BA,KACA+K,EAH0B,EAG1BA,SACAE,EAJ0B,EAI1BA,cASJ,IAb8B,EAK1B3K,aAQgB2K,EAChB,OAAO,KAEX,IAAMzK,EAaV,SAAuBN,EAAWF,EAAWW,GACzC,OAAQT,GACJ,KAAKL,IACD,OAAO,cAAC,IAAD,aAAuBc,OAAQA,GAAYX,IACtD,QACI,OAAO,MAlBCmL,CAAcJ,EAAU/K,EAAMiL,GAE9C,OAAKzK,EAKD,qBAAKzB,UAAWJ,IAAOyM,MAAvB,SACK5K,IALE,KCXR,SAAS6K,EAAT,GAA2C,IAApBnK,EAAmB,EAAnBA,SAC1B,OACI,eAAC,IAAD,CAAUoK,QAASC,IAAnB,UACI,cAACX,EAAD,IACC1J,K,WCbPsK,EAAQ,IAAIC,MAGX,SAAShL,EAAkBD,GAC9BmH,qBAAU,WACNnH,EAAQgL,EAAO,CAAEE,sBAAsB,MACxC,CAAClL,IALRgL,EAAMG,IAAM,8E,oBCHZtG,EAAOC,QAAU,CAAC,MAAQ,wBAAwB,aAAe,+BAA+B,MAAQ,wBAAwB,SAAW,6B,gBCA3ID,EAAOC,QAAU,CAAC,KAAO,mBAAmB,SAAW,uBAAuB,WAAa,yBAAyB,UAAY,0B,gBCAhID,EAAOC,QAAU,CAAC,UAAY,0BAA0B,QAAU,wBAAwB,MAAQ,sBAAsB,WAAa,6B,yFCC/HsG,EAAa,UACbC,EAAa,UAEZ,SAASnP,EAAa/C,GAEzB,OADkBwC,IAAO2P,SAASF,EAAYjS,IAAUwC,IAAO2P,SAASD,EAAYlS,GACjEiS,EAAaC,I,iBCNpCxG,EAAOC,QAAU,CAAC,UAAY,kCAAkC,QAAU,gCAAgC,SAAW,mC,mBCArHD,EAAOC,QAAU,CAAC,OAAS,+BAA+B,SAAW,mC,kBCArED,EAAOC,QAAU,CAAC,UAAY,iCAAiC,MAAQ,+B,gBCAvED,EAAOC,QAAU,CAAC,MAAQ,qBAAqB,YAAc,6B,yMCStD,SAASyG,EAAT,GAGI,IAFPtS,EAEM,EAFNA,GACAmB,EACM,EADNA,KAEMC,EAAW8E,aAAY,SAACrG,GAAD,OAAW8L,YAAgB9L,EAAOG,MAEzDiI,EAAWC,cACX7G,EAiBV,SAA8BD,EAAmB6G,GAC7C,OAAOtG,uBAAY,SAAC3B,GAIZiI,EAHC7G,EAGQmK,cAFAD,YAAY,CAAEtL,UAI5B,CAACiI,EAAU7G,IAxBOmR,CAAqBnR,EAAU6G,GAC9C3G,EA0BV,SAAkCF,EAAmB6G,GACjD,OAAOtG,uBAAY,SAAC3B,EAAII,GAEhB6H,EADA7G,EACSb,YAAqB,CAAEP,KAAII,cAE3BkL,YAAY,CAAEtL,UAE5B,CAACoB,EAAU6G,IAjCWuK,CAAyBpR,EAAU6G,GAEtD1C,EAkCV,SAAgCpE,GAI5B,MAAO,CACHsR,SAAU,WACV5O,KAAM,OACND,IAAK,OACLR,MAPUjC,EAAO,KAQjBkC,OAPWlC,EAAO,MApCRmC,CAAuBnC,GAErC,OACI,qBAAKoE,MAAOA,EAAZ,SACI,cAAC,IAAD,CACIvF,GAAIA,EACJmB,KAAMA,EACNE,aAAcA,EACdC,iBAAkBA,M,qBCT3B,SAASoR,EAAT,GAMI,IAAD,EALNtL,EAKM,EALNA,EACAC,EAIM,EAJNA,EACAlG,EAGM,EAHNA,KACAwR,EAEM,EAFNA,SACAC,EACM,EADNA,WAEMpF,EAAOtH,aAAY,SAACrG,GAAD,OAAW8N,YAAsB9N,EAAOuH,EAAGC,MAC9DW,EAAO,OAAGwF,QAAH,IAAGA,OAAH,EAAGA,EAAMxF,QAFhB,EA6BV,SAAsBZ,EAAWC,EAAW0K,GACxC,IAAM9J,EAAWC,cAEjB,OAAO2K,aAAQ,iBAAO,CAClBC,OAAQ1M,IACR2M,QAAS,kBAAMhB,GACfiB,KAAM,SAACzM,GAAD,OAgBd,SAAoB0B,EAAwBb,EAAWC,EAAvD,GAAyF,IAArBrH,EAAoB,EAApBA,GAC5DA,IAAO6Q,IAAU7Q,GACjBiI,EAASrI,YAAY,CACjBwH,IACAC,IACArH,GAAIiT,cACJ/S,MAAO2Q,IAAU3Q,MACjBC,OAAQ0Q,IAAU1Q,OAClBC,UAAWyQ,IAAUzQ,aAGzB6H,EAASkF,YAAU,CAAE/F,IAAGC,IAAGrH,QA3BGkT,CAAWjL,EAAUb,EAAGC,EAAGd,IACzDG,QAAS,SAACC,GAAD,MAAc,CACnBwM,SAAUxM,EAAQwM,SAClBJ,UAAWpM,EAAQoM,eAEvB,CAAC3L,EAAGC,EAAG0K,EAAO9J,IAnCkBmL,CAAahM,EAAGC,OAF1BgE,IAAZrD,GAHR,0BAKGmL,EALH,EAKGA,OAAQJ,EALX,EAKWA,QAAWC,EALtB,KAOA1N,EAAYL,IACdC,IAAOsI,MADiB,mBAGnBtI,IAAOyN,SAAWA,GAHC,cAInBzN,IAAO0N,WAAaA,GAJD,cAKnB1N,IAAOmO,UAAYF,GAAUJ,GALV,IAStBxN,EA2BV,SAAuB+N,GACnB,IAAMnS,EAAOmS,EAAW,KACxB,MAAO,CACHlQ,MAAOjC,EACPkC,OAAQlC,GA/BEoG,CAAcpG,GAE5B,OACI,qBACIqE,IAAKwN,EACL1N,UAAWA,EACXC,MAAOA,EAHX,SAKKyC,EAAU,cAACsK,EAAD,CAAWtS,GAAIgI,EAAS7G,KAAMA,IAAW,OCxCzD,SAASoS,EAAT,GAAoC,IAApBD,EAAmB,EAAnBA,SACbtI,EAAU9E,YAAYuH,KACtBxC,EAAO/E,YAAYwH,KAEnBnI,EAUV,SAA2ByF,EAAiBC,EAAcqI,GACtD,MAAO,CACHlQ,MAAQ4H,EAAUsI,EAAY,KAC9BjQ,OAAS4H,EAAOqI,EAAY,MAblBE,CAAkBxI,EAASC,EAAMqI,GACzCtH,EAgBV,SAAuBhB,EAAiBC,EAAcqI,GAGlD,IAFA,IAAMtH,EAAQ,GAEL3E,EAAI,EAAGA,EAAI4D,EAAM5D,IAGtB,IAFA,IAAMsL,EAAiB,IAANtL,EAERD,EAAI,EAAGA,EAAI4D,EAAS5D,IAAK,CAC9B,IAAMwL,EAAaxL,IAAM4D,EAAU,EAEnCgB,EAAM3L,KACF,cAACqS,EAAD,CAEItL,EAAGA,EACHC,EAAGA,EACHlG,KAAMmS,EACNX,SAAUA,EACVC,WAAYA,GALPxL,EAAI,IAAMC,IAW/B,OAAO2E,EAtCOyH,CAAczI,EAASC,EAAMqI,GAE3C,OACI,qBAAKhO,UAAWJ,IAAOwO,KAAMnO,MAAOA,EAApC,SACKyG,I,qBCLA2H,EAAQrK,gBAAK,YAA0B,IAAvBhE,EAAsB,EAAtBA,UACnB2C,EAAWC,cAGjB,OACI,qBAAK5C,UAAWL,IAAWC,IAAO+E,MAAO3E,GAAzC,SACI,qBACIA,UAAWJ,IAAO0O,YAClBnO,QANY,kBAAMwC,EAASsD,gBAI/B,SAII,cAACgI,EAAD,CAAMD,SAhBC,c,iBCNvB1H,EAAOC,QAAU,CAAC,MAAQ,iC,gBCA1BD,EAAOC,QAAU,CAAC,KAAO,qB,iBCAzBD,EAAOC,QAAU,CAAC,MAAQ,uB,8BCD1B,0CAGAgI,IAASC,OAAO,cAAC,IAAD,IAASC,SAASC,eAAe,U","file":"static/js/main.e3609f08.chunk.js","sourcesContent":["export enum Direction {\n    North = 'north',\n    South = 'south',\n    West = 'west',\n    East = 'east',\n    None = 'none'\n}\n\nexport interface Token {\n    id: string\n    color: string\n    symbol: string\n    direction: Direction\n}\n\nexport interface TokenCreate {\n    id: string\n    x: number\n    y: number\n    color: string\n    symbol: string\n    direction: Direction\n}\n\nexport interface TokenUpdate {\n    id: string\n    color?: string\n    symbol?: string\n    direction?: Direction\n}\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit'\nimport { RootState } from '../app'\nimport { Token, TokenCreate, TokenUpdate, Direction } from './types'\n\ninterface State {\n    ids: string[]\n    entities: { [id: string]: Token }\n}\n\nconst initialState: State = {\n    ids: [],\n    entities: {}\n}\n\nexport const slice = createSlice({\n    name: 'tokens',\n    initialState,\n    reducers: {\n\n        createToken(state, action: PayloadAction<TokenCreate>) {\n            const { id, color, symbol, direction } = action.payload\n            const token = { id, color, symbol, direction }\n            state.ids.push(id)\n            state.entities[id] = token\n        },\n\n        updateToken(state, action: PayloadAction<TokenUpdate>) {\n            const id = action.payload.id\n            const token = state.entities[id]\n\n            if (token) {\n                state.entities[id] = {\n                    ...token,\n                    ...action.payload\n                }\n            }\n        },\n\n        toggleTokenDirection(state, action: PayloadAction<{ id: string, direction: Direction }>) {\n            const { id, direction } = action.payload\n            const token = state.entities[id]\n\n            if (!token) {\n                return\n            }\n\n            if (token.direction !== direction) {\n                token.direction = direction\n            } else {\n                token.direction = Direction.None\n            }\n        },\n\n        deleteToken(state, action: PayloadAction<{ id: string }>) {\n            const { id } = action.payload\n            const index = state.ids.indexOf(id)\n\n            if (index > -1) {\n                state.ids.splice(index, 1)\n                delete state.entities[id]\n            }\n        }\n\n    }\n})\n\nexport const getTokenIds = (state: RootState) => state.content.present.tokens.ids\nexport const findTokenById = (state: RootState, id: string): Token | undefined => state.content.present.tokens.entities[id]\n\nexport const {\n    createToken,\n    updateToken,\n    toggleTokenDirection,\n    deleteToken\n} = slice.actions\n","import { useCallback, MouseEvent } from 'react'\nimport chroma from 'chroma-js'\nimport classNames from 'classnames'\nimport { getTextColor } from '../shared'\nimport { Direction } from './types'\nimport styles from './BaseToken.module.css'\n\ntype Props = {\n    id: string\n    size: number,\n    color: string,\n    symbol: string,\n    direction: Direction,\n    selected: boolean,\n    onTokenClick?: (id: string) => void\n    onDirectionClick?: (id: string, direction: Direction) => void\n    circleRef?: any\n    containerClassName?: string\n    circleClassName?: string\n}\n\ntype DirectionProps = {\n    direction: Direction\n    currentDirection: Direction\n    onClick: (event: MouseEvent) => void\n    className: string\n    style: any\n}\n\nexport function BaseToken({\n    id,\n    size,\n    color,\n    symbol,\n    direction,\n    selected,\n    onTokenClick,\n    onDirectionClick,\n    circleRef,\n    containerClassName,\n    circleClassName\n}: Props) {\n    // Event handlers\n    const onCircleClick = useCircleClick(id, onTokenClick)\n    const onNorthClick = useDirectionClick(Direction.North, id, onDirectionClick)\n    const onSouthClick = useDirectionClick(Direction.South, id, onDirectionClick)\n    const onWestClick = useDirectionClick(Direction.West, id, onDirectionClick)\n    const onEastClick = useDirectionClick(Direction.East, id, onDirectionClick)\n\n    // Styling\n\n    const colors = generateColors(color)\n    const containerStyle = generateContainerStyle(size)\n    const circleStyle = generateCircleStyle(colors)\n    const northStyle = generateNorthStyle(size, colors)\n    const southStyle = generateSouthStyle(size, colors)\n    const westStyle = generateWestStyle(size, colors)\n    const eastStyle = generateEastStyle(size, colors)\n\n    const containerClasses = classNames(\n        styles.container,\n        { [styles.selected]: selected },\n        containerClassName\n    )\n\n    const circleClasses = classNames(\n        styles.circle,\n        circleClassName\n    )\n\n    // JSX\n\n    return (\n        <div\n            className={containerClasses}\n            style={containerStyle}\n        >\n\n            <div\n                ref={circleRef}\n                onClick={onCircleClick}\n                className={circleClasses}\n                style={circleStyle}\n            >\n                <span>{symbol}</span>\n            </div>\n\n            <DirectionNode\n                direction={Direction.North}\n                currentDirection={direction}\n                onClick={onNorthClick}\n                className={styles.north}\n                style={northStyle}\n            />\n\n            <DirectionNode\n                direction={Direction.South}\n                currentDirection={direction}\n                onClick={onSouthClick}\n                className={styles.south}\n                style={southStyle}\n            />\n\n            <DirectionNode\n                direction={Direction.West}\n                currentDirection={direction}\n                onClick={onWestClick}\n                className={styles.west}\n                style={westStyle}\n            />\n\n            <DirectionNode\n                direction={Direction.East}\n                currentDirection={direction}\n                onClick={onEastClick}\n                className={styles.east}\n                style={eastStyle}\n            />\n\n        </div>\n    )\n}\n\nfunction DirectionNode({\n    direction,\n    currentDirection,\n    onClick,\n    className,\n    style\n}: DirectionProps) {\n    const current = direction === currentDirection\n    return (\n        <div\n            onClick={onClick}\n            className={classNames(className, styles.direction, { [styles.current]: current })}\n            style={style}\n        />\n    )\n}\n\n// Event handlers\n\nfunction useCircleClick(\n    id: string,\n    onTokenClick?: (id: string) => void\n) {\n    return useCallback((event) => {\n        if (onTokenClick) {\n            event.stopPropagation()\n            onTokenClick(id)\n        }\n    }, [id, onTokenClick])\n}\n\nfunction useDirectionClick(\n    direction: Direction, id: string,\n    onDirectionClick?: (id: string, direction: Direction) => void\n) {\n    return useCallback((event) => {\n        if (onDirectionClick) {\n            event.stopPropagation()\n            onDirectionClick(id, direction)\n        }\n    }, [direction, id, onDirectionClick])\n}\n\n// Styling\n\ntype Colors = {\n    backgroundColor: string\n    borderColor: string\n    textColor: string\n}\n\nfunction generateColors(color: string): Colors {\n    const chromaticity = chroma(color).get('lch.c')\n    const saturate = chromaticity > 10 ? 2 : 0\n\n    return {\n        backgroundColor: color,\n        borderColor: chroma(color).darken(2).saturate(saturate).hex(),\n        textColor: getTextColor(color)\n    }\n}\n\nfunction generateContainerStyle(size: number) {\n    return {\n        width: size + 'px',\n        height: size + 'px'\n    }\n}\n\nfunction generateCircleStyle(colors: Colors) {\n    return {\n        backgroundColor: colors.backgroundColor,\n        borderColor: colors.borderColor,\n        color: colors.textColor\n    }\n}\n\nfunction generateNorthStyle(size: number, colors: Colors) {\n    const borderWidth = generateBorderWidth(size)\n    return {\n        top: 0,\n        left: generatePosition(size),\n        borderLeftWidth: borderWidth,\n        borderRightWidth: borderWidth,\n        borderBottomWidth: borderWidth,\n        borderBottomColor: colors.borderColor\n    }\n}\n\nfunction generateSouthStyle(size: number, colors: Colors) {\n    const borderWidth = generateBorderWidth(size)\n    return {\n        bottom: 0,\n        left: generatePosition(size),\n        borderLeftWidth: borderWidth,\n        borderRightWidth: borderWidth,\n        borderTopWidth: borderWidth,\n        borderTopColor: colors.borderColor\n    }\n}\n\nfunction generateWestStyle(size: number, colors: Colors) {\n    const borderWidth = generateBorderWidth(size)\n    return {\n        top: generatePosition(size),\n        left: 0,\n        borderTopWidth: borderWidth,\n        borderBottomWidth: borderWidth,\n        borderRightWidth: borderWidth,\n        borderRightColor: colors.borderColor\n    }\n}\n\nfunction generateEastStyle(size: number, colors: Colors) {\n    const borderWidth = generateBorderWidth(size)\n    return {\n        top: generatePosition(size),\n        right: 0,\n        borderTopWidth: borderWidth,\n        borderBottomWidth: borderWidth,\n        borderLeftWidth: borderWidth,\n        borderLeftColor: colors.borderColor\n    }\n}\n\nfunction generateBorderWidth(size: number) {\n    return ((size / 10) * 3) + 'px'\n}\n\nfunction generatePosition(size: number) {\n    return (size / 5) + 'px'\n}\n","import { useSelector } from '../app'\nimport { getSelectedTokenId } from '../view'\nimport { findTokenById } from './state'\nimport { Direction } from './types'\nimport { BaseToken } from './BaseToken'\n\ntype Props = {\n    id: string\n    size: number\n    onTokenClick?: (id: string) => void\n    onDirectionClick?: (id: string, direction: Direction) => void\n    circleRef?: any\n    containerClassName?: string\n    circleClassName?: string\n}\n\nexport function DynamicToken({\n    id,\n    size,\n    onTokenClick,\n    onDirectionClick,\n    circleRef,\n    containerClassName,\n    circleClassName\n}: Props) {\n    // State\n    const selected = useSelector(state => getSelectedTokenId(state) === id)\n    const token = useSelector(state => findTokenById(state, id))\n    const symbol = token ? token.symbol : ''\n    const color = token ? token.color : '#cfd8dc'\n    const direction = token ? token.direction : Direction.None\n\n    return (\n        <BaseToken\n            id={id}\n            size={size}\n            color={color}\n            symbol={symbol}\n            direction={direction}\n            selected={selected}\n            onTokenClick={onTokenClick}\n            onDirectionClick={onDirectionClick}\n            circleRef={circleRef}\n            containerClassName={containerClassName}\n            circleClassName={circleClassName}\n        />\n    )\n}\n","import { useDrag } from 'react-dnd'\nimport classNames from 'classnames'\nimport { useDisablePreview } from '../dnd'\nimport { DynamicToken } from './DynamicToken'\nimport { Direction } from './types'\nimport styles from './DraggableToken.module.css'\n\ntype Props = {\n    id: string\n    size: number\n    onTokenClick?: (id: string) => void\n    onDirectionClick?: (id: string, direction: Direction) => void\n}\n\nexport const TOKEN_DND_TYPE = 'Token'\n\nexport interface TokenDndItem {\n    id: string\n    size: number\n}\n\nexport function DraggableToken(props: Props) {\n    const { id, size } = props\n\n    const item: TokenDndItem = { id, size }\n\n    const [{ dragging }, drag, preview] = useDrag(() => ({\n        type: TOKEN_DND_TYPE,\n        item,\n        collect: (monitor) => ({ dragging: !!monitor.isDragging() })\n    }), [id, size])\n\n    useDisablePreview(preview)\n\n    const containerClassName = classNames({\n        [styles.dragging]: dragging\n    })\n\n    return (\n        <DynamicToken\n            {...props}\n            circleRef={drag}\n            containerClassName={containerClassName}\n            circleClassName={styles.circle}\n        />\n    )\n}\n","import { XYCoord } from 'react-dnd'\nimport { DynamicToken } from './DynamicToken'\n\ntype Props = {\n    id: string\n    size: number\n    offset: XYCoord\n}\n\nexport function DraggableTokenPreview({\n    id,\n    size,\n    offset\n}: Props) {\n    const style = generateStyle(size, offset)\n    return (\n        <div style={style}>\n            <DynamicToken\n                id={id}\n                size={size}\n            />\n        </div>\n    )\n}\n\nfunction generateStyle(size: number, offset: XYCoord) {\n    const diff = (size / 20) * 3\n    const x = offset.x - diff\n    const y = offset.y - diff\n    return { transform: `translate(${x}px, ${y}px)` }\n}\n","import { ReactNode } from 'react'\nimport styles from './Toolbar.module.css'\n\ntype Props = {\n    children: ReactNode\n}\n\nexport function ToolbarGroup({ children }: Props) {\n    return (\n        <div className={styles.group}>\n            {children}\n        </div>\n    )\n}\n","import styles from './Toolbar.module.css'\n\ntype Props = {\n    label: string\n    disabled?: boolean\n    onClick: () => void\n}\n\n// TODO Icons statt Text\nexport function ToolbarButton({\n    label,\n    disabled,\n    onClick\n}: Props) {\n    return (\n        <button\n            className={styles.button}\n            onClick={onClick}\n            disabled={disabled}\n        >\n            {label}\n        </button>\n    )\n}\n","import { useCallback } from 'react'\nimport { useSelector, useDispatch } from '../../app'\nimport { deleteToken } from '../../token'\nimport { getSelectedTokenId } from '../../view'\nimport { ToolbarButton } from '../ToolbarButton'\n\nexport function DeleteTokenToolbarButton() {\n    const tokenId = useSelector((state) => getSelectedTokenId(state))\n    const disabled = !tokenId\n\n    const dispatch = useDispatch()\n    const onClick = useCallback(() => {\n        if (tokenId) {\n            dispatch(deleteToken({\n                id: tokenId\n            }))\n        }\n    }, [tokenId, dispatch])\n\n    return (\n        <ToolbarButton\n            label=\"Delete\"\n            disabled={disabled}\n            onClick={onClick}\n        />\n    )\n}\n","import { ToolbarGroup } from '../ToolbarGroup'\nimport { DeleteTokenToolbarButton } from './DeleteTokenToolbarButton'\n\nexport function TokenToolbarGroup() {\n    return (\n        <ToolbarGroup>\n            <DeleteTokenToolbarButton />\n        </ToolbarGroup>\n    )\n}\n","import { ActionCreators } from 'redux-undo'\nimport { useSelector, useDispatch, RootState } from '../../app'\nimport { ToolbarButton } from '../ToolbarButton'\n\nexport function UndoToolbarButton() {\n    const undoable = useSelector(isUndoable)\n    const disabled = !undoable\n\n    const dispatch = useDispatch()\n    const onClick = () => dispatch(ActionCreators.undo())\n\n    return (\n        <ToolbarButton\n            label=\"Undo\"\n            onClick={onClick}\n            disabled={disabled}\n        />\n    )\n}\n\nfunction isUndoable(state: RootState): boolean {\n    for (let value of Object.values(state)) {\n        const sub = value as any\n\n        if (sub && sub.past && sub.past.length > 0) {\n            return true\n        }\n    }\n\n    return false\n}\n","import { ActionCreators } from 'redux-undo'\nimport { useSelector, useDispatch, RootState } from '../../app'\nimport { ToolbarButton } from '../ToolbarButton'\n\nexport function RedoToolbarButton() {\n    const redoable = useSelector(isRedoable)\n    const disabled = !redoable\n\n    const dispatch = useDispatch()\n    const onClick = () => dispatch(ActionCreators.redo())\n\n    return (\n        <ToolbarButton\n            label=\"Redo\"\n            onClick={onClick}\n            disabled={disabled}\n        />\n    )\n}\n\nfunction isRedoable(state: RootState): boolean {\n    for (let value of Object.values(state)) {\n        const sub = value as any\n\n        if (sub && sub.future && sub.future.length > 0) {\n            return true\n        }\n    }\n\n    return false\n}\n","import { ToolbarGroup } from '../ToolbarGroup'\nimport { UndoToolbarButton } from './UndoToolbarButton'\nimport { RedoToolbarButton } from './RedoToolbarButton'\n\nexport function HistoryToolbarGroup() {\n    return (\n        <ToolbarGroup>\n            <UndoToolbarButton />\n            <RedoToolbarButton />\n        </ToolbarGroup>\n    )\n}\n","import { useDispatch } from '../../app'\nimport { togglePanel } from '../../view'\nimport { ToolbarButton } from '../ToolbarButton'\n\nexport function TogglePanelToolbarButton() {\n    const dispatch = useDispatch()\n    const onClick = () => dispatch(togglePanel())\n\n    return (\n        <ToolbarButton\n            label=\"Panel\"\n            onClick={onClick}\n        />\n    )\n}\n","import { ToolbarGroup } from '../ToolbarGroup'\nimport { TogglePanelToolbarButton } from './TogglePanelToolbarButton'\n\nexport function ViewToolbarGroup() {\n    return (\n        <ToolbarGroup>\n            <TogglePanelToolbarButton />\n        </ToolbarGroup>\n    )\n}\n","import { memo } from 'react'\nimport classNames from 'classnames'\nimport styles from './Toolbar.module.css'\nimport { TokenToolbarGroup } from './token'\nimport { HistoryToolbarGroup } from './history'\nimport { ViewToolbarGroup } from './view'\n\ntype Props = {\n    className?: string\n}\n\nexport const Toolbar = memo(({ className }: Props) => {\n    return (\n        <div className={classNames(styles.container, className)}>\n            <TokenToolbarGroup />\n            <HistoryToolbarGroup />\n            <ViewToolbarGroup />\n        </div>\n    )\n})\n","import { useSelector as useSelectorRaw, useDispatch as useDispatchRaw } from 'react-redux'\nimport { configureStore, combineReducers } from '@reduxjs/toolkit'\nimport undoable, { groupByActionTypes } from 'redux-undo'\nimport { slice as tokens } from '../token'\nimport { slice as field, groupedFieldActions } from '../field'\nimport { slice as view } from '../view'\n\nconst undoOptions = {\n    limit: 100,\n    groupBy: groupByActionTypes(groupedFieldActions)\n}\n\nexport const store = configureStore({\n    reducer: {\n        content: undoable(combineReducers({\n            [tokens.name]: tokens.reducer,\n            [field.name]: field.reducer\n        }), undoOptions),\n        [view.name]: view.reducer\n    }\n})\n\nexport type RootState = ReturnType<typeof store.getState>\nexport type RootDispatch = typeof store.dispatch\n\nexport function useSelector<TState = RootState, TSelected = unknown>(\n    selector: (state: TState) => TSelected,\n    equalityFn?: (left: TSelected, right: TSelected) => boolean\n) : TSelected {\n    return useSelectorRaw(selector, equalityFn)\n}\n\nexport const useDispatch = () => useDispatchRaw<RootDispatch>()\n","import { CSSProperties } from 'react'\nimport { Toolbar } from '../toolbar'\nimport { Field } from '../field'\nimport { PanelContainer } from '../panel'\nimport { isPanelVisible } from '../view'\nimport { useSelector } from './store'\nimport styles from './Layout.module.css'\nimport './base.css'\n\nexport function Layout() {\n    const panel = useSelector(isPanelVisible)\n    const style = generateContainerStyle(panel)\n\n    return (\n        <div className={styles.container} style={style}>\n            <Toolbar className={styles.toolbar} />\n            <Field className={styles.field} />\n            {panel ? <PanelContainer className={styles.tokenPanel} /> : null}\n        </div>\n    )\n}\n\nfunction generateContainerStyle(panel: boolean): CSSProperties {\n    const fieldWidth = 'auto'\n    const panelWidth = panel ? '200px' : '0px'\n\n    return {\n        gridTemplateColumns: `${fieldWidth} ${panelWidth}`\n    }\n}\n","import { StrictMode } from 'react'\nimport { Provider } from 'react-redux'\nimport { ActionCreators } from 'redux-undo'\nimport { DndProvider } from '../dnd'\nimport { Layout } from './Layout'\nimport { store } from './store'\nimport { updateFieldDimensions } from '../field'\n\nexport function App() {\n    return (\n        <StrictMode>\n            <Provider store={store}>\n                <DndProvider>\n                    <Layout />\n                </DndProvider>\n            </Provider>\n        </StrictMode>\n    )\n}\n\nstore.dispatch(updateFieldDimensions({\n    columns: 5,\n    rows: 5\n}))\n\nstore.dispatch(ActionCreators.clearHistory())\n","import { createSlice, PayloadAction } from '@reduxjs/toolkit'\nimport { RootState } from '../app'\nimport { deleteToken } from '../token'\n\ninterface State {\n    panelVisible: boolean\n    selectedTokenId?: string\n}\n\nconst initialState: State = {\n    panelVisible: true,\n    selectedTokenId: undefined\n}\n\nexport const slice = createSlice({\n    name: 'view',\n    initialState,\n    reducers: {\n\n        togglePanel(state) {\n            state.panelVisible = !state.panelVisible\n        },\n\n        selectToken(state, action: PayloadAction<{ id: string }>) {\n            const { id } = action.payload\n            state.selectedTokenId = id\n        },\n\n        deselectToken(state) {\n            state.selectedTokenId = undefined\n        }\n\n    },\n    extraReducers: (builder) => {\n\n        builder.addCase(deleteToken, (state, action) => {\n            const { id } = action.payload\n\n            if (state.selectedTokenId === id) {\n                state.selectedTokenId = undefined\n            }\n        })\n\n    }\n})\n\nexport const isPanelVisible = (state: RootState) => state.view.panelVisible\nexport const getSelectedTokenId = (state: RootState) => state.view.selectedTokenId\nexport const isTokenSelected = (state: RootState, id: string) => state.view.selectedTokenId === id\n\nexport const {\n    togglePanel,\n    selectToken,\n    deselectToken\n} = slice.actions\n","export * from './types'\nexport * from './state'\nexport { Field } from './Field'\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"element\":\"Forms_element__3Ktu0\",\"label\":\"Forms_label__9aoLd\",\"input\":\"Forms_input__34n01\",\"select\":\"Forms_select__32bDl\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"BaseToken_container__jdpcL\",\"circle\":\"BaseToken_circle__170NU\",\"direction\":\"BaseToken_direction__3CpQa\",\"selected\":\"BaseToken_selected__2gzaC\",\"current\":\"BaseToken_current__12_Yh\",\"north\":\"BaseToken_north__Nv6fV\",\"south\":\"BaseToken_south__3fbS4\",\"west\":\"BaseToken_west__3DAO8\",\"east\":\"BaseToken_east__28uYt\"};","import { createSlice, PayloadAction } from '@reduxjs/toolkit'\nimport { RootState } from '../app'\nimport { createToken, deleteToken } from '../token'\nimport { Cell } from './types'\n\nexport const MIN_DIMENSIONS = 1\nexport const MAX_DIMENSIONS = 100\n\ninterface State {\n    columns: number\n    rows: number,\n    cells: Cell[][]\n}\n\nconst initialState: State = {\n    columns: 1,\n    rows: 1,\n    cells: [ [ createCell(0, 0) ] ]\n}\n\nexport const slice = createSlice({\n    name: 'field',\n    initialState,\n    reducers: {\n\n        updateFieldDimensions(state, action: PayloadAction<{ columns: number, rows: number }>) {\n            const columns = normalizeDimension(action.payload.columns)\n            const rows = normalizeDimension(action.payload.rows)\n\n            // Columns\n\n            const columnsDiff = columns - state.columns\n\n            if (columnsDiff > 0) {\n                growColumns(state, columnsDiff)\n            } else if (columnsDiff < 0) {\n                shrinkColumns(state, Math.abs(columnsDiff))\n            }\n\n            state.columns = columns\n\n            // Rows\n\n            const rowsDiff = rows - state.rows\n\n            if (rowsDiff > 0) {\n                growRows(state, rowsDiff)\n            } else if (rowsDiff < 0) {\n                shrinkRows(state, Math.abs(rowsDiff))\n            }\n\n            state.rows = rows\n        },\n\n        moveToken(state, action: PayloadAction<{ id: string, x: number, y: number }>) {\n            const { id, x, y } = action.payload\n            removeToken(state, id)\n            state.cells[x][y].tokenId = id\n        }\n\n    },\n    extraReducers: (builder) => {\n\n        builder.addCase(createToken, (state, action) => {\n            const { id, x, y } = action.payload\n            state.cells[x][y].tokenId = id\n        })\n\n        builder.addCase(deleteToken, (state, action) => {\n            const { id } = action.payload\n            removeToken(state, id)\n        })\n\n    }\n})\n\nfunction normalizeDimension(value: number) {\n    return Math.max(MIN_DIMENSIONS, Math.min(MAX_DIMENSIONS, value))\n}\n\nfunction createCell(x: number, y: number, tokenId?: string): Cell {\n    return {\n        x,\n        y,\n        tokenId\n    }\n}\n\nfunction growColumns(state: State, increase: number) {\n    const columnsStart = state.columns\n    const columnsEnd = state.columns + increase\n\n    for (let x = columnsStart; x < columnsEnd; x++) {\n        state.cells[x] = []\n\n        for (let y = 0; y < state.rows; y++) {\n            state.cells[x][y] = createCell(x, y)\n        }\n    }\n}\n\nfunction removeToken(state: State, id: string) {\n    for (let x = 0; x < state.columns; x++) {\n        for (let y = 0; y < state.rows; y++) {\n            const cell = state.cells[x][y]\n\n            if (cell.tokenId === id) {\n                cell.tokenId = undefined\n                break\n            }\n        }\n    }\n}\n\nfunction growRows(state: State, increase: number) {\n    const rowsStart = state.rows\n    const rowsEnd = state.rows + increase\n\n    for (let x = 0; x < state.columns; x++) {\n        for (let y = rowsStart; y < rowsEnd; y++) {\n            state.cells[x][y] = createCell(x, y)\n        }\n    }\n}\n\nfunction shrinkColumns(state: State, decrease: number) {\n    const columnsStart = state.columns - decrease\n    const columnsEnd = state.columns\n\n    for (let x = columnsStart; x < columnsEnd; x++) {\n        for (let y = 0; y < state.rows; y++) {\n            const tokenId = state.cells[x][y]\n            // TODO Delete Token\n            console.log('TODO Delete Token:', tokenId)\n        }\n    }\n\n    state.cells.splice(columnsStart, decrease)\n}\n\nfunction shrinkRows(state: State, decrease: number) {\n    const rowsStart = state.rows - decrease\n    const rowsEnd = state.rows\n\n    for (let x = 0; x < state.columns; x++) {\n        for (let y = rowsStart; y < rowsEnd; y++) {\n            const tokenId = state.cells[x][y]\n            // TODO Delete Token\n            console.log('TODO Delete Token:', tokenId)\n        }\n\n        state.cells[x].splice(rowsStart, decrease)\n    }\n}\n\nexport const getColumns = (state: RootState) => state.content.present.field.columns\nexport const getRows = (state: RootState) => state.content.present.field.rows\nexport const findCellByCoordinates = (state: RootState, x: number, y: number) => {\n    const column = state.content.present.field.cells[x]\n    return column ? column[y] : undefined\n}\n\nexport const {\n    updateFieldDimensions,\n    moveToken\n} = slice.actions\n\nexport const groupedFieldActions = [\n    updateFieldDimensions.type\n]\n","import { useState, useEffect, ChangeEvent } from 'react'\n\nexport const useInput = (\n    initialValue: any,\n    listener?: (value: any) => void\n): [any, any, (value: any) => void] => {\n    const [value, setValue] = useState(initialValue)\n\n    useEffect(() => setValue(initialValue), [initialValue])\n\n    const bind = {\n        value,\n        onChange: (event: ChangeEvent<any>) => {\n            setValue(event.target.value)\n            if (listener) {\n                listener(event.target.value)\n            }\n        }\n    }\n\n    return [\n        bind,\n        value,\n        setValue\n    ]\n}\n","import { useCallback, FocusEventHandler } from 'react'\nimport { useInput } from './use-input'\nimport styles from './Forms.module.css'\n\ntype Props = {\n    label?: string\n    max: number\n    value: string\n    onChange: (value: string) => void\n    onFocus: FocusEventHandler<any>\n}\n\nexport function TextField({\n    label,\n    max,\n    value,\n    onChange,\n    onFocus\n}: Props) {\n    const changeHandler = useChangeHandler(max, onChange)\n    const [bind] = useInput(value, changeHandler)\n\n    return (\n        <div className={styles.element}>\n            {label ? <label className={styles.label}>{label}</label> : null}\n            <input\n                className={styles.input}\n                type=\"text\"\n                maxLength={max}\n                onFocus={onFocus}\n                {...bind}\n            />\n        </div>\n    )\n}\n\nfunction useChangeHandler(\n    max: number,\n    onChange: (value: string) => void\n) {\n    return useCallback((value) => {\n        if (value.length <= max) {\n            onChange(value)\n        }\n    }, [max, onChange])\n}\n","import { useCallback, useMemo, CSSProperties } from 'react'\nimport { useInput } from './use-input'\nimport styles from './Forms.module.css'\n\ntype Option = {\n    value: string\n    label?: string\n    style?: CSSProperties\n}\n\ntype Props = {\n    label?: string\n    options: Option[] | any[]\n    value: string\n    onChange: (value: string) => void\n}\n\nexport function SelectField({\n    label,\n    options,\n    value,\n    onChange\n}: Props) {\n    const changeHandler = useChangeHandler(onChange)\n    const [bind, currentValue] = useInput(value, changeHandler)\n\n    const optionsNormalized = useOptions(options)\n    const selectStyle = useSelectStyle(currentValue, optionsNormalized)\n\n    return (\n        <div className={styles.element}>\n            {label ? <label className={styles.label}>{label}</label> : null}\n            <select\n                className={styles.select}\n                style={selectStyle}\n                {...bind}\n            >\n                {optionsNormalized.map(generateOption)}\n            </select>\n        </div>\n    )\n}\n\nfunction useChangeHandler(onChange: (value: string) => void) {\n    return useCallback((value) => {\n        if (onChange) {\n            onChange(value)\n        }\n    }, [onChange])\n}\n\nfunction useOptions(options: Option[] | string[]): Option[] {\n    return useMemo(\n        () => options.map(transformOption),\n        [options]\n    )\n}\n\nfunction transformOption(option: Option | string): Option {\n    let value = null\n    let label = null\n    let style = undefined\n\n    if (typeof option === 'object' && option !== null && option.value !== undefined) {\n        value = option.value\n        label = option.label\n        style = option.style\n    } else {\n        value = option + ''\n    }\n\n    if (label === null || label === undefined) {\n        label = value\n    }\n\n    return {\n        value,\n        label,\n        style\n    }\n}\n\nfunction useSelectStyle(currentValue: string, options: Option[]) {\n    return useMemo(\n        () => getSelectStyle(currentValue, options),\n        [currentValue, options]\n    )\n}\n\nfunction getSelectStyle(currentValue: string, options: Option[]) {\n    const option = options.find(option => option.value === currentValue)\n    return option ? option.style : null\n}\n\nfunction generateOption({ value, label, style }: Option) {\n    return (\n        <option\n            key={value}\n            className={styles.option}\n            value={value}\n            style={style}\n        >\n            {label}\n        </option>\n    )\n}\n","import { ReactNode } from 'react'\nimport styles from './Panel.module.css'\n\ntype Props = {\n    title: string,\n    children: ReactNode,\n    className?: string\n}\n\nexport function Panel({ title, children, className }: Props) {\n    return (\n        <div className={className}>\n            <h1 className={styles.title}>{title}</h1>\n            {children}\n        </div>\n    )\n}\n","import { ReactNode } from 'react'\nimport styles from './PanelCategory.module.css'\n\ntype Props = {\n    title?: string,\n    children: ReactNode\n}\n\nexport function PanelCategory({ title, children }: Props) {\n    return (\n        <div className={styles.container}>\n            {title ? <h2 className={styles.title}>{title}</h2> : null}\n            {children}\n        </div>\n    )\n}\n","import { useCallback } from 'react'\nimport range from 'lodash.range'\nimport { useSelector, useDispatch } from '../app'\nimport { SelectField } from '../forms'\nimport { getColumns, getRows, updateFieldDimensions, MIN_DIMENSIONS, MAX_DIMENSIONS } from '../field'\nimport { Panel } from './Panel'\nimport { PanelCategory } from './PanelCategory'\n\nexport function FieldPanel() {\n    return (\n        <Panel title=\"Field\">\n            <Dimensions />\n        </Panel>\n    )\n}\n\nfunction Dimensions() {\n    const dispatch = useDispatch()\n    const columns = useSelector(getColumns)\n    const rows = useSelector(getRows)\n\n    const columnsChanged = useCallback((columns) => {\n        dispatch(updateFieldDimensions({\n            columns,\n            rows\n        }))\n    }, [dispatch, rows])\n\n    const rowsChanged = useCallback((rows) => {\n        dispatch(updateFieldDimensions({\n            columns,\n            rows\n        }))\n    }, [dispatch, columns])\n\n    return (\n        <PanelCategory>\n            <DimensionSelect\n                label=\"Columns\"\n                value={columns}\n                onChange={columnsChanged}\n            />\n            <DimensionSelect\n                label=\"Rows\"\n                value={rows}\n                onChange={rowsChanged}\n            />\n        </PanelCategory>\n    )\n}\n\ntype DimensionSelectProps = {\n    label: string,\n    value: number,\n    onChange: (value: string) => void\n}\n\nfunction DimensionSelect({\n    label, \n    value,\n    onChange\n}: DimensionSelectProps) {\n    const options = range(MIN_DIMENSIONS, MAX_DIMENSIONS + 1)\n    return (\n        <SelectField\n            label={label}\n            options={options}\n            value={value + ''}\n            onChange={onChange}\n        />\n    )\n}\n","import { useCallback, FocusEvent } from 'react'\nimport { useSelector, useDispatch } from '../app'\nimport { findTokenById, updateToken } from '../token'\nimport { TextField } from '../forms'\n\ntype Props = {\n    id: string\n}\n\nexport function TokenSymbolField({ id }: Props) {\n    const symbol = useSelector(state => {\n        const symbol = findTokenById(state, id)?.symbol\n        return symbol ? symbol : ''\n    })\n\n    const dispatch = useDispatch()\n    const onChange = useCallback((symbol) => {\n        dispatch(updateToken({\n            id,\n            symbol\n        }))\n    }, [dispatch, id])\n\n    const onFocus = (event: FocusEvent<any>) => event.target.select()\n\n    return (\n        <TextField\n            label=\"Symbol\"\n            max={1}\n            value={symbol}\n            onChange={onChange}\n            onFocus={onFocus}\n        />\n    )\n}\n","import { useCallback } from 'react'\nimport { useSelector, useDispatch } from '../app'\nimport { findTokenById, updateToken } from '../token'\nimport { SelectField } from '../forms'\nimport { getTextColor } from '../shared'\n\nconst colors = [\n    createColor('Yellow', '#fff2cc'),\n    createColor('Red', '#f8cecc'),\n    createColor('Purple', '#d1c4e9'),\n    createColor('Blue', '#bbdefb'),\n    createColor('Green', '#d5e8d4'),\n    createColor('Grey', '#cfd8dc'),\n    createColor('Dark yellow', '#fdd835'),\n    createColor('Dark red', '#c62828'),\n    createColor('Dark purple', '#673ab7'),\n    createColor('Dark blue', '#1976d2'),\n    createColor('Dark green', '#2e7d32'),\n    createColor('Dark gray', '#647687')\n]\n\nfunction createColor(label: string, color: string) {\n    return {\n        label,\n        value: normalizeColor(color),\n        style: {\n            backgroundColor: color,\n            color: getTextColor(color)\n        }\n    }\n}\n\nfunction normalizeColor(color?: string) {\n    return color ? color.toLowerCase() : null\n}\n\ntype Props = {\n    id: string\n}\n\n// TODO Nicht bekannte Farbe als Option darstellen.\nexport function TokenColorSelection({ id }: Props) {\n    const color = useSelector(state => {\n        const color = findTokenById(state, id)?.color\n        return normalizeColor(color)\n    })\n\n    const dispatch = useDispatch()\n    const onChange = useCallback((color) => {\n        dispatch(updateToken({\n            id,\n            color\n        }))\n    }, [dispatch, id])\n\n    return color ? (\n        <SelectField\n            label=\"Color\"\n            options={colors}\n            value={color}\n            onChange={onChange}\n        />\n    ) : null\n}\n","import { useCallback } from 'react'\nimport { useSelector, useDispatch } from '../app'\nimport { Direction, findTokenById, updateToken } from '../token'\nimport { SelectField } from '../forms'\n\nconst directions = [\n    { label: '🡅 North', value: Direction.North },\n    { label: '🡆 East', value: Direction.East },\n    { label: '🡇 South', value: Direction.South },\n    { label: '🡄 West', value: Direction.West },\n    { label: 'None', value: Direction.None }\n]\n\ntype Props = {\n    id: string\n}\n\nexport function TokenDirectionSelection({ id }: Props) {\n    const direction = useSelector(state => {\n        const direction = findTokenById(state, id)?.direction\n        return direction ? direction : Direction.None\n    })\n\n    const dispatch = useDispatch()\n    const onChange = useCallback((direction) => {\n        dispatch(updateToken({\n            id,\n            direction\n        }))\n    }, [dispatch, id])\n\n    return (\n        <SelectField\n            label=\"Direction\"\n            options={directions}\n            value={direction}\n            onChange={onChange}\n        />\n    )\n}\n","import { Panel } from './Panel'\nimport { PanelCategory } from './PanelCategory'\nimport { TokenSymbolField } from './TokenSymbolField'\nimport { TokenColorSelection } from './TokenColorSelection'\nimport { TokenDirectionSelection } from './TokenDirectionSelection'\n\ntype Props = {\n    id: string\n}\n\nexport function TokenPanel({ id }: Props) {\n    return (\n        <Panel title=\"Token\">\n            <PanelCategory>\n                <TokenSymbolField id={id} />\n                <TokenColorSelection id={id} />\n                <TokenDirectionSelection id={id} />\n            </PanelCategory>\n        </Panel>\n    )\n}\n","import { useDrag } from 'react-dnd'\nimport classNames from 'classnames'\nimport { useDisablePreview } from '../dnd'\nimport { BaseToken, Direction, TOKEN_DND_TYPE, TokenDndItem } from '../token'\nimport { Panel } from './Panel'\nimport styles from './NewToken.module.css'\n\nexport const NEW_TOKEN = {\n    id: '',\n    color: '#cfd8dc',\n    symbol: '',\n    direction: Direction.None\n}\n\nconst item: TokenDndItem = {\n    id: NEW_TOKEN.id,\n    size: 100\n}\n\nexport function NewToken() {\n    const [{ dragging }, drag, preview] = useDrag(() => ({\n        type: TOKEN_DND_TYPE,\n        item,\n        collect: (monitor) => ({ dragging: !!monitor.isDragging() })\n    }))\n\n    useDisablePreview(preview)\n\n    const className = classNames(\n        styles.token,\n        { [styles.dragging]: dragging }\n    )\n\n    return (\n        <Panel title=\"Neuer Token\" className={styles.panel}>\n            <div className={styles.tokenWrapper}>\n                <BaseToken\n                    id={item.id}\n                    size={item.size}\n                    color={NEW_TOKEN.color}\n                    symbol=\"\"\n                    direction={Direction.None}\n                    selected={false}\n                    circleRef={drag}\n                    circleClassName={className}\n                />\n            </div>\n        </Panel>\n    )\n}\n","import { memo } from 'react'\nimport { useSelector } from 'react-redux'\nimport classNames from 'classnames'\nimport { getSelectedTokenId } from '../view'\nimport { FieldPanel } from './FieldPanel'\nimport { TokenPanel } from './TokenPanel'\nimport { NewToken } from './NewToken'\nimport styles from './PanelContainer.module.css'\n\ntype Prop = {\n    className?: string\n}\n\nexport const PanelContainer = memo(({ className }: Prop) => {\n    const selectedTokenId = useSelector(getSelectedTokenId)\n\n    return (\n        <div className={classNames(styles.container, className)}>\n            <div className={styles.dynamic}>\n                {selectedTokenId\n                    ? <TokenPanel id={selectedTokenId} />\n                    : <FieldPanel />\n                }\n            </div>\n            <div className={styles.newToken}>\n                <NewToken />\n            </div>\n        </div>\n    )\n})\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"Toolbar_container__3wR26\",\"group\":\"Toolbar_group__38d8m\",\"button\":\"Toolbar_button__1im3b\"};","import { useDragLayer, XYCoord } from 'react-dnd'\nimport { TOKEN_DND_TYPE, DraggableTokenPreview } from '../token'\nimport styles from './CustomDragLayer.module.css'\n\nexport function CustomDragLayer() {\n    const {\n        item,\n        itemType,\n        currentOffset,\n        isDragging\n    } = useDragLayer(monitor => ({\n        item: monitor.getItem(),\n        itemType: monitor.getItemType(),\n        currentOffset: monitor.getSourceClientOffset(),\n        isDragging: monitor.isDragging()\n    }))\n\n    if (!isDragging || !currentOffset) {\n        return null\n    }\n    const preview = renderPreview(itemType, item, currentOffset)\n\n    if (!preview) {\n        return null\n    }\n\n    return (\n        <div className={styles.layer}>\n            {preview}\n        </div>\n    )\n}\n\nfunction renderPreview(type: any, item: any, offset: XYCoord) {\n    switch (type) {\n        case TOKEN_DND_TYPE:\n            return <DraggableTokenPreview offset={offset} {...item} />\n        default:\n            return null\n    }\n}\n","import { ReactNode } from 'react'\nimport { DndProvider as Provider } from 'react-dnd'\nimport { HTML5Backend } from 'react-dnd-html5-backend'\nimport { CustomDragLayer } from './CustomDragLayer'\n\ntype Props = {\n    children: ReactNode\n}\n\n// TODO Aktuell kein TouchBackend mit \"enableMouseEvents: true\" weil:\n// Unterschied durch Touch-Backend zwischen Mouse und Touch:\n// Bei Mouse wird nach Drag die Selektierung von Tokens aufgehoben (durch Click-Event auf Grid).\nexport function DndProvider({ children }: Props) {\n    return (\n        <Provider backend={HTML5Backend}>\n            <CustomDragLayer />\n            {children}\n        </Provider>\n    )\n}\n","import { useEffect } from 'react'\nimport { ConnectDragPreview } from 'react-dnd'\n\nconst empty = new Image()\nempty.src = 'data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=='\n\nexport function useDisablePreview(preview: ConnectDragPreview) {\n    useEffect(() => {\n        preview(empty, { captureDraggingState: true })\n    }, [preview])\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"panel\":\"NewToken_panel__3BGVk\",\"tokenWrapper\":\"NewToken_tokenWrapper__3f-4t\",\"token\":\"NewToken_token__3SYsc\",\"dragging\":\"NewToken_dragging__jMWyn\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"cell\":\"Cell_cell__fv93r\",\"firstRow\":\"Cell_firstRow__2E9oE\",\"lastColumn\":\"Cell_lastColumn__2WNNW\",\"droppable\":\"Cell_droppable__1P9wT\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"Layout_container__2El7r\",\"toolbar\":\"Layout_toolbar__37LM2\",\"field\":\"Layout_field__3DuOE\",\"tokenPanel\":\"Layout_tokenPanel__3M8Lg\"};","import chroma from 'chroma-js'\n\nconst BLACK_TEXT = '#000000'\nconst WHITE_TEXT = '#FFFFFF'\n\nexport function getTextColor(color: string): string {\n    const blackText = chroma.contrast(BLACK_TEXT, color) >= chroma.contrast(WHITE_TEXT, color)\n    return blackText ? BLACK_TEXT : WHITE_TEXT\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"PanelContainer_container__12MNC\",\"dynamic\":\"PanelContainer_dynamic__1-Gue\",\"newToken\":\"PanelContainer_newToken__3Scll\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"circle\":\"DraggableToken_circle__2e89C\",\"dragging\":\"DraggableToken_dragging__3643i\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"PanelCategory_container__2ywKt\",\"title\":\"PanelCategory_title__2RLOE\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"field\":\"Field_field__1PltA\",\"gridWrapper\":\"Field_gridWrapper__oluTN\"};","import { CSSProperties, useCallback } from 'react'\nimport { useSelector, useDispatch, RootDispatch } from '../app'\nimport { DraggableToken, toggleTokenDirection } from '../token'\nimport { selectToken, deselectToken, isTokenSelected } from '../view'\n\ntype Props = {\n    id: string\n    size: number\n}\n\nexport function CellToken({\n    id,\n    size\n}: Props) {\n    const selected = useSelector((state) => isTokenSelected(state, id))\n\n    const dispatch = useDispatch()\n    const onTokenClick = useTokenClickHandler(selected, dispatch)\n    const onDirectionClick = useDirectionClickHandler(selected, dispatch)\n\n    const style = generateContainerStyle(size)\n\n    return (\n        <div style={style}>\n            <DraggableToken\n                id={id}\n                size={size}\n                onTokenClick={onTokenClick}\n                onDirectionClick={onDirectionClick}\n            />\n        </div>\n    )\n}\n\nfunction useTokenClickHandler(selected: boolean, dispatch: RootDispatch) {\n    return useCallback((id) => {\n        if (!selected) {\n            dispatch(selectToken({ id }))\n        } else {\n            dispatch(deselectToken())\n        }\n    }, [dispatch, selected])\n}\n\nfunction useDirectionClickHandler(selected: boolean, dispatch: RootDispatch) {\n    return useCallback((id, direction) => {\n        if (selected) {\n            dispatch(toggleTokenDirection({ id, direction }))\n        } else {\n            dispatch(selectToken({ id }))\n        }\n    }, [selected, dispatch])\n}\n\nfunction generateContainerStyle(size: number): CSSProperties {\n    const width = size + 'px'\n    const height = size + 'px'\n\n    return {\n        position: 'absolute',\n        left: '-1px',\n        top: '-1px',\n        width,\n        height\n    }\n}\n","import { CSSProperties } from 'react'\nimport { useDrop } from 'react-dnd'\nimport { v4 as uuidv4 } from 'uuid'\nimport classNames from 'classnames'\nimport { useSelector, useDispatch, RootDispatch } from '../app'\nimport { createToken, TokenDndItem, TOKEN_DND_TYPE } from '../token'\nimport { NEW_TOKEN } from '../panel'\nimport { findCellByCoordinates, moveToken } from './state'\nimport { CellToken } from './CellToken'\nimport styles from './Cell.module.css'\n\ntype Props = {\n    x: number,\n    y: number,\n    size: number,\n    firstRow: boolean,\n    lastColumn: boolean\n}\n\nexport function Cell({\n    x,\n    y,\n    size,\n    firstRow,\n    lastColumn\n}: Props) {\n    const cell = useSelector((state) => findCellByCoordinates(state, x, y))\n    const tokenId = cell?.tokenId\n    const empty = tokenId === undefined\n\n    const [{ isOver, canDrop }, drop] = useDroppable(x, y, empty)\n\n    const className = classNames(\n        styles.cell,\n        {\n            [styles.firstRow]: firstRow,\n            [styles.lastColumn]: lastColumn,\n            [styles.droppable]: isOver && canDrop\n        }\n    )\n\n    const style = generateStyle(size)\n\n    return (\n        <div\n            ref={drop}\n            className={className}\n            style={style}\n        >\n            {tokenId ? <CellToken id={tokenId} size={size} /> : null}\n        </div>\n    )\n}\n\nfunction useDroppable(x: number, y: number, empty: boolean) {\n    const dispatch = useDispatch()\n\n    return useDrop(() => ({\n        accept: TOKEN_DND_TYPE,\n        canDrop: () => empty,\n        drop: (item: TokenDndItem) => handleDrop(dispatch, x, y, item),\n        collect: (monitor) => ({\n            isOver: !!monitor.isOver(),\n            canDrop: !!monitor.canDrop()\n        })\n    }), [x, y, empty, dispatch])\n}\n\nfunction generateStyle(cellSize: number): CSSProperties {\n    const size = cellSize + 'px'\n    return {\n        width: size,\n        height: size\n    }\n}\n\nfunction handleDrop(dispatch: RootDispatch, x: number, y: number, { id }: TokenDndItem) {\n    if (id === NEW_TOKEN.id) {\n        dispatch(createToken({\n            x,\n            y,\n            id: uuidv4(),\n            color: NEW_TOKEN.color,\n            symbol: NEW_TOKEN.symbol,\n            direction: NEW_TOKEN.direction\n        }))\n    } else {\n        dispatch(moveToken({ x, y, id }))\n    }\n}\n","import styles from './Grid.module.css'\nimport { useSelector } from '../app'\nimport { getColumns, getRows } from './state'\nimport { Cell } from './Cell'\n\ntype Props = {\n    cellSize: number\n}\n\nexport function Grid({ cellSize }: Props) {\n    const columns = useSelector(getColumns)\n    const rows = useSelector(getRows)\n\n    const style = generateGridStyle(columns, rows, cellSize)\n    const cells = generateCells(columns, rows, cellSize)\n\n    return (\n        <div className={styles.grid} style={style}>\n            {cells}\n        </div>\n    )\n}\n\nfunction generateGridStyle(columns: number, rows: number, cellSize: number) {\n    return {\n        width: (columns * cellSize) + 'px',\n        height: (rows * cellSize) + 'px'\n    }\n}\n\nfunction generateCells(columns: number, rows: number, cellSize: number) {\n    const cells = []\n\n    for (let y = 0; y < rows; y++) {\n        const firstRow = y === 0\n\n        for (let x = 0; x < columns; x++) {\n            const lastColumn = x === columns - 1\n\n            cells.push(\n                <Cell\n                    key={x + ';' + y}\n                    x={x}\n                    y={y}\n                    size={cellSize}\n                    firstRow={firstRow}\n                    lastColumn={lastColumn}\n                />\n            )\n        }\n    }\n\n    return cells\n}\n","import { memo } from 'react'\nimport classNames from 'classnames'\nimport { useDispatch } from '../app'\nimport { deselectToken } from '../view'\nimport { Grid } from './Grid'\nimport styles from './Field.module.css'\n\nconst BASE_CELL_SIZE = 100\n\ntype Prop = {\n    className?: string\n}\n\nexport const Field = memo(({ className }: Prop) => {\n    const dispatch = useDispatch()\n    const onDeselectToken = () => dispatch(deselectToken())\n\n    return (\n        <div className={classNames(styles.field, className)}>\n            <div\n                className={styles.gridWrapper}\n                onClick={onDeselectToken}\n            >\n                <Grid cellSize={BASE_CELL_SIZE} />\n            </div>\n        </div>\n    )\n})\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"layer\":\"CustomDragLayer_layer__3Oi1J\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"grid\":\"Grid_grid__5dSy0\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"title\":\"Panel_title__2jCxg\"};","import ReactDOM from 'react-dom'\nimport { App } from './app'\n\nReactDOM.render(<App />, document.getElementById('root'))\n"],"sourceRoot":""}